import{S as E}from"./Scrollbar.35f3acb4.js";import{bt as U,y as f,I as S,aQ as p,f as k,bs as N,aq as $,n as b,z as C,A as a,H as t,D as x,F as v,C as e,aZ as M,G as I,ab as o,U as D,O as r,_ as H,ci as O,bG as F,av as K,aY as G,a0 as q,ax as Q,cj as Y}from"./index.5bd2a348.js";import{_ as z}from"./Tooltip.vue_vue_type_script_setup_true_lang.f3cd2719.js";import{u as A}from"./use-theme-vars.84cf6e4b.js";import{C as Z}from"./Close.dd91702e.js";import{N as V}from"./Icon.4c613503.js";import{_ as J,a as X}from"./RelayAddButton.vue_vue_type_script_setup_true_lang.0e659ecb.js";import{_ as W}from"./RelayConnectListCard.vue_vue_type_script_setup_true_lang.57e40453.js";import{_ as ee,a as te}from"./RelayWritableButton.vue_vue_type_script_setup_true_lang.0c1036e4.js";import{_ as P}from"./Input.d0fcd3c4.js";import{_ as se}from"./Space.ba3d3247.js";import{_ as ne}from"./AddButton.vue_vue_type_script_setup_true_lang.844b02a9.js";import{M as oe}from"./MdSearch.4e4001b3.js";const ae={},ce={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},le=p("path",{d:"M12 22H5a2 2 0 0 1-2-2l.01-14c0-1.1.88-2 1.99-2h1V3c0-.55.45-1 1-1s1 .45 1 1v1h8V3c0-.55.45-1 1-1s1 .45 1 1v1h1c1.1 0 2 .9 2 2v6h-2v-2H5v10h7v2zm10.13-5.01l.71-.71a.996.996 0 0 0 0-1.41l-.71-.71a.996.996 0 0 0-1.41 0l-.71.71l2.12 2.12zm-.71.71l-5.01 5.01c-.18.18-.44.29-.7.29H14.5c-.28 0-.5-.22-.5-.5v-1.21c0-.27.11-.52.29-.71l5.01-5.01l2.12 2.13z",fill:"currentColor"},null,-1),re=[le];function _e(d,c){return f(),S("svg",ce,re)}const ie=U(ae,[["render",_e]]),ue={key:0},de=k({__name:"Broadcast",setup(d){const c=N(),s=$(null);function i(){const n=o.broadcast({slef:D({})});if(!n){c.error(r("message.broadcast_error_message"));return}s.value=n}const l=b(()=>{var n,y,u,h,m,g,R,B;return((y=(n=s.value)==null?void 0:n.numberOfSuccesses)!=null?y:0)+((h=(u=s.value)==null?void 0:u.numberOfErrors)!=null?h:0)+((g=(m=s.value)==null?void 0:m.numberOfOvertime)!=null?g:0)<((B=(R=s.value)==null?void 0:R.total)!=null?B:0)}),_=A();return(n,y)=>{const u=H;return f(),C(z,{tooltip:e(o).hasChange()?e(r)("tips.broadcast_has_change_tip"):e(r)("tips.broadcast_no_change_tip")},{default:a(()=>[t(u,{onClick:i,type:"default",loading:e(l),disabled:e(l)||e(o).hasChange()},{default:a(()=>[x(v(e(l)?e(r)("success_timeout_failure_total"):e(r)("broadcast"))+" ",1),s.value?(f(),S("span",ue,[p("span",{style:M({color:e(_).successColor})},v(s.value.numberOfSuccesses),5),x(" / "),p("span",{style:M({color:e(_).warningColor})},v(s.value.numberOfOvertime),5),x(" / "),p("span",{style:M({color:e(_).errorColor})},v(s.value.numberOfErrors),5),x(" / "),p("span",null,v(s.value.total),1)])):I("",!0)]),_:1},8,["loading","disabled"])]),_:1},8,["tooltip"])}}}),T=k({__name:"ButtonClose",emits:["click"],setup(d,{emit:c}){return(s,i)=>{const l=V,_=H;return f(),C(_,{text:"",circle:"",type:"error",class:"text-[#6c5ce7] hover:text-[#a29bfe]",onClick:i[0]||(i[0]=n=>c("click",n))},{icon:a(()=>[t(l,null,{default:a(()=>[t(Z)]),_:1})]),_:1})}}}),me={key:1},pe=k({__name:"RelayConfigurator",setup(d){const c=b(()=>Object.keys(o.getConfiguration()));function s(m){o.hasWriteByUrl(m)?o.remoteWrite(m):o.addWrite(m)}function i(m){o.hasReadByUrl(m)?o.remoteRead(m):o.addRead(m)}const l=$("");function _(){!l.value||o.addWriteRead(l.value)}const n=N();function y(){o.save(),n.success(r("message.relay_configurator_save_message"))}function u(){o.sync(),n.success(r("message.relay_configurator_sync_message"))}const h=b(()=>{const m=o.getUpdateAt();return m||null});return(m,g)=>{const R=ie,B=P,L=H;return f(),C(W,{urls:e(c),title:e(r)("relay_configuration")},{"header-extra":a(()=>[t(e(V),{class:"mr-1"},{default:a(()=>[t(R)]),_:1}),e(h)?(f(),C(J,{key:0,secondTimestamp:e(h)},null,8,["secondTimestamp"])):(f(),S("span",me,"null"))]),right:a(({url:w})=>[t(ee,{active:e(o).hasWriteByUrl(w),class:"mr-1",onSwitch:()=>s(w)},null,8,["active","onSwitch"]),t(te,{active:e(o).hasReadByUrl(w),class:"mr-2",onSwitch:()=>i(w)},null,8,["active","onSwitch"]),t(T,{text:"",onClick:()=>e(o).remove(w)},null,8,["onClick"])]),action:a(()=>[t(e(se),null,{default:a(()=>[t(B,{value:l.value,"onUpdate:value":g[0]||(g[0]=w=>l.value=w),type:"text",placeholder:"eg: wss://nostr.wine"},null,8,["value"]),t(L,{onClick:_,type:"primary",disabled:!l.value},{default:a(()=>[x(v(e(r)("add")),1)]),_:1},8,["disabled"]),t(z,{tooltip:e(o).hasChange()?e(r)("tips.save_changes"):e(r)("tips.currently_not_modified")},{default:a(()=>[t(L,{onClick:y,type:"primary",disabled:!e(o).hasChange()},{default:a(()=>[x(v(e(r)("save")),1)]),_:1},8,["disabled"])]),_:1},8,["tooltip"]),t(z,{tooltip:e(o).hasChange()?e(r)("tips.relay_configurator_sync_has_change_tip"):e(r)("tips.relay_configurator_sync_no_change_tip")},{default:a(()=>[t(L,{onClick:u,type:"primary",disabled:e(o).hasChange()},{default:a(()=>[x(v(e(r)("sync")),1)]),_:1},8,["disabled"])]),_:1},8,["tooltip"]),t(de)]),_:1})]),_:1},8,["urls","title"])}}}),fe={},he={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},ve=p("path",{d:"M17 11h3a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-3a2 2 0 0 0-2 2v1H9.01V5a2 2 0 0 0-2-2H4c-1.1 0-2 .9-2 2v4a2 2 0 0 0 2 2h3a2 2 0 0 0 2-2V8h2v7.01c0 1.65 1.34 2.99 2.99 2.99H15v1a2 2 0 0 0 2 2h3a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-3a2 2 0 0 0-2 2v1h-1.01c-.54 0-.99-.45-.99-.99V8h2v1c0 1.1.9 2 2 2z",fill:"currentColor"},null,-1),ye=[ve];function ge(d,c){return f(),S("svg",he,ye)}const j=U(fe,[["render",ge]]),xe={class:"flex-shrink-0"},Ce=k({__name:"RelayConnected",setup(d){const c=b(()=>O.getPool()),s=b(()=>[...c.value.keys()]);function i(_){const n=O.getRelayFromPool(_);return n?n.subIds.size:0}function l(_){const n=O.getRelayFromPool(_);return n?n.publishIds.size:0}return(_,n)=>{const y=V;return f(),C(W,{urls:e(s),title:e(r)("active_relay")},{"header-extra":a(()=>[t(y,{class:"mr-1"},{default:a(()=>[t(j)]),_:1}),x(" "+v(e(s).length),1)]),right:a(({url:u})=>[p("span",xe," ("+v(i(u))+","+v(l(u))+") ",1),t(ne,{disabled:e(o).hasReadByUrl(u)||e(o).hasWriteByUrl(u),class:"ml-2",onClick:()=>e(o).addWriteRead(u)},null,8,["disabled","onClick"]),t(T,{class:"ml-2",onClick:()=>e(O).close(u),onClose:()=>{var h;return(h=e(c).get(u))==null?void 0:h.close()}},null,8,["onClick","onClose"])]),_:1},8,["urls","title"])}}}),we={},be={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ke=p("path",{d:"M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85c-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28c77.418-.07 144.315-53.144 162.787-126.849c1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z",fill:"currentColor"},null,-1),$e=[ke];function Se(d,c){return f(),S("svg",be,$e)}const Ve=U(we,[["render",Se]]);function Re(d,{message:c,dialog:s}){return new Promise((i,l)=>{o.sync({onlyUrl:d,onEvent(_,n){s.success({title:r("success"),content:r("handel_sync_on_event_message",{url:n}),positiveText:r("yes")}),i("pull")},onPush(){c.success(r("handel_sync_on_push_message",{url:d})),i("push")}}),c.info(r("handel_sync_info",{url:d}))})}function Be(d){const c=F(),s=N(),i=$(),l=$("default"),_=A(),n=b(()=>{switch(l.value){case"pull":return _.value.successColor;case"push":return _.value.primaryColor;default:return _.value.textColor1}});return{isLoading:i,status:l,color:n,handelSync:async()=>{i.value=!0,l.value=await Re(e(d),{message:s,dialog:c}),i.value=!1}}}const Oe=k({__name:"SyncButton",props:{url:null},setup(d){const c=d,{handelSync:s,status:i,isLoading:l,color:_}=Be(K(c,"url"));return(n,y)=>{const u=V,h=H;return f(),C(z,{tooltip:e(r)("sync_tooltip")},{default:a(()=>[t(h,{text:"",onClick:e(s),class:G({turn:e(l)})},{default:a(()=>[t(u,{color:e(_)},{default:a(()=>[t(Ve)]),_:1},8,["color"])]),_:1},8,["onClick","class"])]),_:1},8,["tooltip"])}}});const ze=U(Oe,[["__scopeId","data-v-99831d93"]]),Ue={class:"flex items-center justify-center flex-shrink flex-grow"},He={class:"flex-shrink-0 flex justify-center items-center"},Le={class:"flex-shrink ml-2 flex-grow w-32 sm:w-auto"},Me=k({__name:"RelayOther",setup(d){const c=$(""),s=$([]),i=b(()=>o.getOtherList());function l(){if(c.value===""){s.value=Array.from(i.value);return}s.value=Array.from(i.value).filter(n=>n.includes(c.value))}l();const _=q(l,1e3);return Q([c,i],_,{deep:!0}),(n,y)=>{const u=V,h=oe,m=P;return f(),C(W,{loadable:"",urls:s.value,title:e(r)("more")},{"header-extra":a(()=>[p("div",Ue,[p("div",He,[t(u,{class:"mr-1"},{default:a(()=>[t(j)]),_:1}),p("span",null,v(s.value.length),1)]),p("div",Le,[t(m,{round:"",placeholder:e(r)("search"),value:c.value,"onUpdate:value":y[0]||(y[0]=g=>c.value=g),onKeyup:Y(l,["enter"]),onChange:l},{suffix:a(()=>[t(u,null,{default:a(()=>[t(h)]),_:1})]),_:1},8,["placeholder","value","onKeyup"])])])]),right:a(({url:g})=>[t(X,{class:"mr-2",url:g},null,8,["url"]),t(ze,{url:g},null,8,["url"])]),_:1},8,["urls","title"])}}}),Ne={class:"mt-2"},We={class:"mt-2"},Ze=k({__name:"RelayConfig",setup(d){return(c,s)=>(f(),C(e(E),{class:"h-full w-full"},{default:a(()=>[p("div",null,[t(pe)]),p("div",Ne,[t(Ce)]),p("div",We,[t(Me)])]),_:1}))}});export{Ze as _};
