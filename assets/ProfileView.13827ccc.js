import{g as ce,c as A,a as pe}from"./Contact.ea8c2fb1.js";import{a as _e,g as te}from"./user.fc7031f0.js";import{p as fe}from"./profile-2-400x400.238412c3.js";import{E as de}from"./Ellipsis.253ff5d9.js";import{a2 as me,Z as ve,f as C,av as D,bD as S,n as _,dk as U,y as f,I as w,H as t,A as s,L as R,J as ne,C as e,z as $,aA as ye,f4 as ke,D as x,F as P,dj as be,at as B,db as ge,_ as M,O as k,aM as oe,aU as we,bz as ae,G as F,bA as I,aV as h,cr as he,b3 as xe,ar as O,cR as $e,bP as Le,V,f5 as Ee,b2 as Fe,Q as De,da as Ce}from"./index.d4beb9d4.js";import{e as Be,a as Pe,p as Me,j as Se,_ as Ue,k as Ae,l as Oe,m as Re}from"./Content.8be18bd0.js";import{g as se,p as Ve}from"./use.e428b080.js";import{_ as le,a as Ne}from"./FollowItem.vue_vue_type_script_setup_true_lang.7874b2cb.js";import{_ as re}from"./ListItem.666b7fc1.js";import{u as ze,S as Ie}from"./Scrollbar.a74a5321.js";import{_ as N}from"./PostList.vue_vue_type_script_setup_true_lang.f712bb57.js";import{a as je}from"./RelayAddButton.vue_vue_type_script_setup_true_lang.735c4e9a.js";import{a as Ke}from"./AddButton.vue_vue_type_script_setup_true_lang.ef072c2b.js";import{_ as We,a as Te}from"./RelayWritableButton.vue_vue_type_script_setup_true_lang.90beb046.js";import{_ as Je,a as qe}from"./Tabs.0128b035.js";import{u as Ge,r as ee}from"./naiveUi.3bf7422c.js";import{_ as He}from"./UserMetadataEditing.vue_vue_type_script_setup_true_lang.6cbc3da9.js";import{_ as z}from"./Space.efc7ad45.js";import{_ as Qe}from"./Dropdown.75f1bb37.js";import{b as Ze}from"./nostr.47476c5c.js";import"./createGarbageFilter.5dbcc016.js";import"./getCacheStaff.91029245.js";import"./event.ce5eb45a.js";import"./autoAddRelayurlByEventIdStaff.2b1ec972.js";import"./Markdown.57fa6aca.js";import"./MavonEditor.104735e2.js";import"./use-theme-vars.a322f4f7.js";import"./Tag.e49d23ad.js";import"./Icon.7dabd37c.js";import"./Drawer.vue_vue_type_script_setup_true_lang.1bab6a71.js";import"./DrawerContent.46dce308.js";import"./RelayInfoView.6d09c0b2.js";import"./ContentBlacklistView.1ecd7aa0.js";import"./Input.217a6f50.js";import"./Empty.501abe6f.js";import"./NaddrLink.vue_vue_type_script_setup_true_lang.2d9d8164.js";import"./UserLink.vue_vue_type_script_setup_true_lang.04cd38ad.js";import"./ReloadCircleSharp.85fc38a8.js";import"./Scrollbar.89fcbc4c.js";import"./PapawList.vue_vue_type_script_setup_true_lang.84c8759f.js";import"./UploadButton.vue_vue_type_script_setup_true_lang.b65d5358.js";import"./CloudUpload.0cb91451.js";import"./get-slot.4ceacf82.js";import"./create.2deeaf6a.js";function Xe(d){return me(`createTipEventLine:${d.pubkey}`,()=>Be({filters:[{kinds:[10001],authors:[d.pubkey]}],...d}).addStaff(ve()),{useLocalStorage:!1})}const Ye=C({__name:"Follow",props:{pubkey:null,urls:null,active:{type:Boolean}},setup(d){const m=d,o=D(!1),{pubkey:a,urls:r,active:c}=S(m),p=_(()=>(o.value=!o.value,ce(a.value,{urls:r==null?void 0:r.value}))),n=U(),g=_(()=>n.value?a.value===n.value?A.getContactConfiguration():p.value.feat.getContactList():[]),u=D(void 0);return se(u,{active:c}),(v,l)=>(f(),w("div",{ref_key:"divRef",ref:u,class:"p-4 box-border"},[t(e(re),null,{default:s(()=>[(f(!0),w(R,null,ne(e(g),i=>(f(),$(le,{key:i.pubkey,contact:i,pubkey:i.pubkey,name:i.name},null,8,["contact","pubkey","name"]))),128))]),_:1})],512))}}),et=C({__name:"Follower",props:{pubkey:null,active:{type:Boolean},urls:null},setup(d){const m=d,{pubkey:o,active:a}=S(m),r=_(()=>pe(o.value)),c=_(()=>r.value.getList());ze(r,a);const p=D(void 0);return se(p,{active:ye(m,"active")}),(n,g)=>(f(),w("div",{ref_key:"divRef",ref:p,class:"p-4 box-border"},[t(e(re),null,{default:s(()=>[(f(!0),w(R,null,ne(e(c),u=>(f(),$(le,{key:u.pubkey,pubkey:u.pubkey},null,8,["pubkey"]))),128))]),_:1})],512))}}),tt=C({__name:"ProfileMoreInfoRelayList",props:{pubkey:null,active:{type:Boolean}},setup(d){const m=d,{pubkey:o}=S(m),a=_(()=>_e(o.value)),r=ke(async()=>{var n;return o.value===((n=await be())!=null?n:"")?{readUrl:B.getReadList(),writeUrl:B.getWriteList(),urls:new Set(Object.keys(B.getData()))}:a.value.feat.getReadWriteList()},void 0),c=_(()=>{var n;return(n=r.value)==null?void 0:n.urls});function p(){ge.push({name:"relays"})}return(n,g)=>{var l;const u=M,v=Pe;return f(),w(R,null,[t(v,{show:e(B).hasChange()},{default:s(()=>[t(u,{onClick:p,type:"primary"},{default:s(()=>[x(P(e(k)("save")),1)]),_:1})]),_:1},8,["show"]),t(Ke,{urls:(l=e(c))!=null?l:[],title:""},{right:s(({url:i})=>{var y,b,L,E;return[t(We,{active:(b=(y=e(r))==null?void 0:y.writeUrl.has(i))!=null?b:!1,class:"mr-1"},null,8,["active"]),t(Te,{active:(E=(L=e(r))==null?void 0:L.readUrl.has(i))!=null?E:!1,class:"mr-2"},null,8,["active"]),t(je,{url:i},null,8,["url"])]}),_:1},8,["urls"])],64)}}}),nt=C({__name:"SMSButtonProvide",props:{insertDropdownOptionList:null},setup(d){const m=d,o=Me();return oe(()=>{var a;for(const r of(a=m.insertDropdownOptionList)!=null?a:[])o.insertDropdownOptionOptList.value.find(p=>p.key===r.key)||o.insertDropdownOption(r)}),(a,r)=>we(a.$slots,"default")}}),ot={key:0},at={key:1},st=C({__name:"ProfileMoreInfo",props:{pubkey:null,urls:null},setup(d){const m=d,{pubkey:o}=S(m);_(()=>[o.value]);const a=D("homepage"),r=Se(),c=U(),p=_(()=>c.value===o.value),n=ae(),g={insertKey:"pin",key:"unpin",async handle(l){r.unpin(l),n.info(k("request_initiated"))},label:k("unpin")},u=_(()=>Xe({pubkey:o.value})),v=_(()=>{var l,i;return p.value?[...r.getData().tagMap.values()]:(i=(l=u.value.feat.getLatestEvent())==null?void 0:l.tags)!=null?i:[]});return(l,i)=>{const y=Ue,b=Je,L=qe;return f(),$(L,{type:"line",value:a.value,"onUpdate:value":i[0]||(i[0]=E=>a.value=E),animated:""},{default:s(()=>[t(b,{"display-directive":"show:lazy",name:"homepage",tab:e(k)("homepage")},{default:s(()=>[e(p)?(f(),w("div",ot,[t(nt,{insertDropdownOptionList:[g]},{default:s(()=>[t(N,{tags:e(v)},null,8,["tags"])]),_:1},8,["insertDropdownOptionList"])])):(f(),w("div",at,[t(N,{tags:e(v)},null,8,["tags"])])),e(v).length>0?(f(),$(y,{key:2},{default:s(()=>[x(P(e(k)("tip")),1)]),_:1})):F("",!0),t(N,{active:a.value==="homepage",filters:[{kinds:[30023],authors:[e(o)]},{kinds:[1],authors:[e(o)]}],urls:m.urls},null,8,["active","filters","urls"])]),_:1},8,["tab"]),t(b,{"display-directive":"show:lazy",name:"follow",tab:e(k)("follow")},{default:s(()=>[t(Ye,{active:a.value==="follow",pubkey:e(o),urls:d.urls},null,8,["active","pubkey","urls"])]),_:1},8,["tab"]),t(b,{"display-directive":"show:lazy",name:"follower",tab:e(k)("follower")},{default:s(()=>[t(et,{active:a.value==="follower",pubkey:e(o)},null,8,["active","pubkey"])]),_:1},8,["tab"]),t(b,{"display-directive":"show:lazy",name:"\u4E2D\u7EE7",tab:e(k)("relay")},{default:s(()=>[t(tt,{active:a.value==="relay",pubkey:e(o)},null,8,["active","pubkey"])]),_:1},8,["tab"])]),_:1},8,["value"])}}}),lt={},rt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ut=h("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44",d:"M358.62 129.28L86.49 402.08L70 442l39.92-16.49l272.8-272.13l-24.1-24.1z"},null,-1),it=h("path",{d:"M413.07 74.84l-11.79 11.78l24.1 24.1l11.79-11.79a16.51 16.51 0 0 0 0-23.34l-.75-.75a16.51 16.51 0 0 0-23.35 0z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44"},null,-1),ct=[ut,it];function pt(d,m){return f(),w("svg",rt,ct)}const _t=I(lt,[["render",pt]]),ft={},dt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},mt=h("path",{d:"M384 336a63.78 63.78 0 0 0-46.12 19.7l-148-83.27a63.85 63.85 0 0 0 0-32.86l148-83.27a63.8 63.8 0 1 0-15.73-27.87l-148 83.27a64 64 0 1 0 0 88.6l148 83.27A64 64 0 1 0 384 336z",fill:"currentColor"},null,-1),vt=[mt];function yt(d,m){return f(),w("svg",dt,vt)}const kt=I(ft,[["render",yt]]),bt=C({__name:"UserDataEditing",emits:["close"],setup(d,{emit:m}){const o=ae(),a=D({}),r=U({intercept:!0}),c=_(()=>{if(!!r.value)return te(r.value)}),p=_(()=>c.value&&c.value.feat.useMetadata());oe(()=>{!p.value||(a.value=p.value)});const n=D(!1);async function g(){var u;n.value=!0,(u=c.value)==null||u.publish({content:JSON.stringify(a.value),kind:0},B.getWriteList(),{addUrl:!0,onOK({ok:v,url:l}){n.value=!1,v?o.success(`\u5DF2\u6210\u529F\u63D0\u4EA4\u5230${l}`):o.error(`\u63D0\u4EA4\u5230${l}\u5931\u8D25`)}})}return(u,v)=>{const l=he,i=xe;return e(c)?(f(),$(i,{key:0,class:"w-[600px] max-w-full max-h-full",title:"\u7F16\u8F91\u7528\u6237\u4FE1\u606F",bordered:!1,role:"dialog","aria-modal":"true"},{default:s(()=>[t(e(z),{vertical:""},{default:s(()=>[t(He,{userMetadata:a.value},null,8,["userMetadata"]),t(e(z),{center:""},{default:s(()=>[t(e(M),{type:"tertiary",onClick:v[0]||(v[0]=()=>m("close"))},{default:s(()=>[x(P(e(k)("cancel")),1)]),_:1}),t(l,{trigger:"hover"},{trigger:s(()=>[t(e(M),{type:"primary",onClick:g,loading:n.value,disabled:n.value},{default:s(()=>[x(P(e(k)("submit")),1)]),_:1},8,["loading","disabled"])]),default:s(()=>[x(" \u5982\u679C\u52A0\u8F7D\u4E0D\u5230\u5408\u9002\u7684\u4FE1\u606F\uFF0C\u90A3\u53EF\u80FD\u662Frelays\u8BBE\u7F6E\u4E0D\u5BF9\u8BF7\u5C1D\u8BD5\u914D\u7F6E\u4E00\u4E0B ")]),_:1}),n.value?(f(),$(l,{key:0,trigger:"hover"},{trigger:s(()=>[t(e(M),{onClick:v[1]||(v[1]=()=>n.value=!1)},{default:s(()=>[x("\u505C\u6B62\u52A0\u8F7D")]),_:1})]),default:s(()=>[x(" \u5982\u679C\u60A8\u662F\u65B0\u7528\u6237\u7684\u8BDD\uFF0C\u6216\u8005\u60A8\u653E\u5F03\u4E4B\u524D\u7684\u4FE1\u606F\u5C31\u53EF\u4EE5\u70B9\u6B64\u5904 ")]),_:1})):F("",!0)]),_:1})]),_:1})]),_:1})):F("",!0)}}}),gt=C({__name:"UserInformationButton",props:{pubkey:null},setup(d){var v;const m=d,{pubkey:o}=S(m),a=Ge(),r=U(),c=_(()=>o.value===r.value),p=D(!1),n=Ae(),g=Oe(),u=D([c.value&&{label:k("edit_user_profile"),key:"editProfile",icon:ee(_t),props:{onclick(){p.value=!p.value}}},{label:k("copy"),key:"clipboard",icon:ee(kt),children:[{label:`${k("copy")} npub`,key:"copy-npub",props:{onclick(){const l=O.npubEncode(o.value);a(l)}}},{label:`${k("copy")} nprofile`,key:"copy-npro",props:{onclick(){const l=O.nprofileEncode({pubkey:o.value,relays:[...B.getWriteList()]});a(l)}}},c.value&&$e()===Le.PrivateKey&&((v=V)==null?void 0:v.getPrivateKey)&&typeof V.getPrivateKey=="function"&&{label:`${k("copy")} nsec`,key:"copy-nsec",props:{onclick(){const l=O.nsecEncode(V.getPrivateKey());a(l)}}},{label:`${k("copy")} publicKey hex`,key:"copy-hex",props:{onclick(){a(o.value)}}}].filter(l=>!!l)},{label:k("recommend_user"),key:"recommendUser",props:{onclick(){n(o.value)}}},{label:k("recommend_metadata"),key:"recommendUserMetadata",props:{onclick(){g(o.value)}}}].filter(l=>!!l));return(l,i)=>{const y=M,b=Qe,L=Ee;return f(),w(R,null,[t(b,{placement:"bottom-start",trigger:"click",options:u.value},{default:s(()=>[t(y,{circle:"",type:"info"},{default:s(()=>[t(Re)]),_:1})]),_:1},8,["options"]),t(L,{show:p.value,"onUpdate:show":i[1]||(i[1]=E=>p.value=E)},{default:s(()=>[t(bt,{onClose:i[0]||(i[0]=()=>p.value=!1)})]),_:1},8,["show"])],64)}}}),wt={key:0,class:"w-full h-full flex flex-col"},ht={class:"flex flex-col"},xt={class:"flex items-center justify-end px-8 mt-4"},$t={key:1},Lt={class:"flex items-center"},Et={class:"w-full",style:{"word-break":"break-all","text-overflow":"ellipsis","word-wrap":"break-word"}},Ft=C({__name:"ProfileView",setup(d){const m=De(),o=U({intercept:!0}),a=_(()=>o.value?O.nprofileEncode({pubkey:o.value,relays:Array.from(B.getWriteList())}):""),r=_(()=>{var y;return(y=m.params.value)!=null?y:a.value}),c=_(()=>Ze(r.value)),p=_(()=>{var y;return((y=c.value)==null?void 0:y.pubkey)===o.value}),n=_(()=>{var y;return(y=c.value)==null?void 0:y.pubkey}),g=_(()=>{var y,b;return((y=c.value)==null?void 0:y.relays)&&new Set((b=c.value)==null?void 0:b.relays)}),u=_(()=>n.value?te(n.value,{urls:g.value}).feat.useMetadata():null),v=_(()=>n.value?A.isFollow(n.value):!1);async function l(){!n.value||(v.value?await A.unFollow(n.value):await A.follow(n.value))}const[i]=Ve(.3);return(y,b)=>{const L=Ce,E=Ne,ue=M,ie=z;return e(n)?(f(),w("div",wt,[t(Ie,{class:"flex-shrink flex-1 h-0",refreshable:"",loadable:""},{default:s(()=>{var j,K,W,T,J,q,G,H,Q;return[h("div",ht,[h("div",{ref_key:"target",ref:i,class:"h-0 w-full relative flex-shrink-0",style:{}},[((W=(j=e(u))==null?void 0:j.banner)!=null?W:(K=e(u))==null?void 0:K.picture)?(f(),$(L,{key:0,src:(q=(T=e(u))==null?void 0:T.banner)!=null?q:(J=e(u))==null?void 0:J.picture,"object-fit":"cover",class:"w-full h-full banner"},null,8,["src"])):F("",!0),t(E,{class:"absolute bottom-0 left-2",style:Fe({transform:"translate(0,50%)"}),round:"",size:100,src:(H=(G=e(u))==null?void 0:G.picture)!=null?H:e(fe)},null,8,["style","src"])],512),h("div",null,[h("div",xt,[t(ie,null,{default:s(()=>[e(p)?F("",!0):(f(),$(ue,{key:0,class:"ml-4",strong:"",round:"",type:e(v)?"warning":"primary",onClick:l},{default:s(()=>[x(P(e(v)?"UnFollow":"Follow"),1)]),_:1},8,["type"])),e(n)?(f(),w("div",$t,[t(gt,{pubkey:e(n)},null,8,["pubkey"])])):F("",!0)]),_:1})]),h("h1",Lt,[t(de,null,{default:s(()=>{var Z,X,Y;return[x(P((Y=(Z=e(u))==null?void 0:Z.name)!=null?Y:(X=e(c))==null?void 0:X.pubkey.slice(0,10)),1)]}),_:1})]),h("div",Et,P((Q=e(u))==null?void 0:Q.about),1)])]),e(n)?(f(),$(st,{key:0,pubkey:e(n),urls:e(g)},null,8,["pubkey","urls"])):F("",!0)]}),_:1})])):F("",!0)}}});const bn=I(Ft,[["__scopeId","data-v-44199ace"]]);export{bn as default};
