import{g as be,c as q,a as ye}from"./Contact.32d0e027.js";import{g as ne,a as ge}from"./user.8ea1c8c2.js";import{p as ie,a as he,i as ke,j as we,k as xe}from"./Content.fd05d731.js";import{E as te}from"./Ellipsis.1f56af6a.js";import{l as Fe,c as re,cp as $e,b as Z,cq as Ce,d as le,f as D,u as Ee,ao as z,m as se,n as v,h as ce,dk as ze,av as Le,o as Be,q as Re,dh as Se,aD as Pe,dl as ee,aF as de,dm as De,b3 as Me,w as je,v as Oe,j as W,aI as Ue,bv as N,y as g,z as S,A as i,aO as L,H as l,C as e,D as B,F as j,G as U,I as P,L as Y,J as pe,V as R,at as Ie,ab as I,di as Ke,_ as A,O as F,bs as ae,bo as Ve,c5 as Ae,aY as Ne,bJ as X,dn as Te,aX as We,Q as He,d2 as Ge}from"./index.6304a51f.js";import{l as Je,g as fe,p as qe}from"./use.cd98c830.js";import{t as Xe}from"./Tag.4cfe5819.js";import{a as Ye,_ as me}from"./ListItem.6e1cd44c.js";import{u as Qe,S as Ze}from"./Scrollbar.9f2302cb.js";import{_ as et}from"./PostList.vue_vue_type_script_setup_true_lang.6811dbe7.js";import{a as tt}from"./RelayAddButton.vue_vue_type_script_setup_true_lang.cbb6a5ee.js";import{a as ot}from"./AddButton.vue_vue_type_script_setup_true_lang.84021d61.js";import{_ as nt,a as at}from"./RelayWritableButton.vue_vue_type_script_setup_true_lang.698c8920.js";import{_ as rt,a as lt}from"./Tabs.2c252f89.js";import{u as st,r as ue}from"./naiveUi.7d31a9d4.js";import{_ as ut}from"./UserMetadataEditing.vue_vue_type_script_setup_true_lang.34b1385d.js";import{_ as oe}from"./Space.7ea99aad.js";import{_ as it}from"./Dropdown.1c3e84b5.js";import{a as ct}from"./nostr.65b69e2e.js";import"./getCacheStaff.4d97934e.js";import"./event.2031a3a5.js";import"./autoAddRelayurlByEventIdStaff.c25d3ca8.js";import"./channel.813781ca.js";import"./ContentBlacklistView.7185fa63.js";import"./Input.9124b0cd.js";import"./Icon.358fada6.js";import"./UserLink.vue_vue_type_script_setup_true_lang.c22273e8.js";import"./DrawerContent.c7a28493.js";import"./RelayInfoView.1d101069.js";import"./use-theme-vars.89c1ef43.js";import"./Popselect.afab5a01.js";import"./create.2deeaf6a.js";import"./Checkmark.e81c784a.js";import"./Empty.559ecf73.js";import"./create-ref-setter.fe4a2903.js";import"./ReloadCircleSharp.aaba4a76.js";import"./Scrollbar.695c977e.js";import"./PapawList.vue_vue_type_script_setup_true_lang.db2caefa.js";import"./composables.f1ca8f3c.js";import"./UploadButton.vue_vue_type_script_setup_true_lang.a96b1a5d.js";import"./CloudUpload.e2ccb3d7.js";import"./get-slot.4ceacf82.js";const dt=Fe("n-avatar-group"),pt=re("avatar",`
 width: var(--n-merged-size);
 height: var(--n-merged-size);
 color: #FFF;
 font-size: var(--n-font-size);
 display: inline-flex;
 position: relative;
 overflow: hidden;
 text-align: center;
 border: var(--n-border);
 border-radius: var(--n-border-radius);
 --n-merged-color: var(--n-color);
 background-color: var(--n-merged-color);
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
`,[$e(Z("&","--n-merged-color: var(--n-color-modal);")),Ce(Z("&","--n-merged-color: var(--n-color-popover);")),Z("img",`
 width: 100%;
 height: 100%;
 `),le("text",`
 white-space: nowrap;
 display: inline-block;
 position: absolute;
 left: 50%;
 top: 50%;
 `),re("icon",`
 vertical-align: bottom;
 font-size: calc(var(--n-merged-size) - 6px);
 `),le("text","line-height: 1.25")]),ft=Object.assign(Object.assign({},ce.props),{size:[String,Number],src:String,circle:{type:Boolean,default:void 0},objectFit:String,round:{type:Boolean,default:void 0},bordered:{type:Boolean,default:void 0},onError:Function,fallbackSrc:String,intersectionObserverOptions:Object,lazy:Boolean,onLoad:Function,renderPlaceholder:Function,renderFallback:Function,imgProps:Object,color:String}),_e=D({name:"Avatar",props:ft,setup(r){const{mergedClsPrefixRef:f,inlineThemeDisabled:s}=Ee(r),u=z(!1);let a=null;const _=z(null),t=z(null),d=()=>{const{value:n}=_;if(n&&(a===null||a!==n.innerHTML)){a=n.innerHTML;const{value:m}=t;if(m){const{offsetWidth:x,offsetHeight:y}=m,{offsetWidth:E,offsetHeight:K}=n,O=.9,V=Math.min(x/E*O,y/K*O,1);n.style.transform=`translateX(-50%) translateY(-50%) scale(${V})`}}},c=se(dt,null),o=v(()=>{const{size:n}=r;if(n)return n;const{size:m}=c||{};return m||"medium"}),b=ce("Avatar","-avatar",pt,ze,r,f),h=se(Xe,null),p=v(()=>{if(c)return!0;const{round:n,circle:m}=r;return n!==void 0||m!==void 0?n||m:h?h.roundRef.value:!1}),k=v(()=>c?!0:r.bordered||!1),w=n=>{var m;if(!M.value)return;u.value=!0;const{onError:x,imgProps:y}=r;(m=y==null?void 0:y.onError)===null||m===void 0||m.call(y,n),x&&x(n)};Le(()=>r.src,()=>u.value=!1);const C=v(()=>{const n=o.value,m=p.value,x=k.value,{color:y}=r,{self:{borderRadius:E,fontSize:K,color:O,border:V,colorModal:H,colorPopover:G},common:{cubicBezierEaseInOut:J}}=b.value;let Q;return typeof n=="number"?Q=`${n}px`:Q=b.value.self[Be("height",n)],{"--n-font-size":K,"--n-border":x?V:"none","--n-border-radius":m?"50%":E,"--n-color":y||O,"--n-color-modal":y||H,"--n-color-popover":y||G,"--n-bezier":J,"--n-merged-size":`var(--n-avatar-size-override, ${Q})`}}),$=s?Re("avatar",v(()=>{const n=o.value,m=p.value,x=k.value,{color:y}=r;let E="";return n&&(typeof n=="number"?E+=`a${n}`:E+=n[0]),m&&(E+="b"),x&&(E+="c"),y&&(E+=Se(y)),E}),C,r):void 0,M=z(!r.lazy);Pe(()=>{if(ee)return;let n;const m=de(()=>{n==null||n(),n=void 0,r.lazy&&(n=De(t.value,r.intersectionObserverOptions,M))});Me(()=>{m(),n==null||n()})});const T=z(!r.lazy);return{textRef:_,selfRef:t,mergedRoundRef:p,mergedClsPrefix:f,fitTextTransform:d,cssVars:s?void 0:C,themeClass:$==null?void 0:$.themeClass,onRender:$==null?void 0:$.onRender,hasLoadError:u,handleError:w,shouldStartLoading:M,loaded:T,mergedOnLoad:n=>{var m;const{onLoad:x,imgProps:y}=r;x==null||x(n),(m=y==null?void 0:y.onLoad)===null||m===void 0||m.call(y,n),T.value=!0}}},render(){var r,f;const{$slots:s,src:u,mergedClsPrefix:a,lazy:_,onRender:t,mergedOnLoad:d,shouldStartLoading:c,loaded:o,hasLoadError:b}=this;t==null||t();let h;const p=!o&&!b&&(this.renderPlaceholder?this.renderPlaceholder():(f=(r=this.$slots).placeholder)===null||f===void 0?void 0:f.call(r));return this.hasLoadError?h=this.renderFallback?this.renderFallback():je(s.fallback,()=>[W("img",{src:this.fallbackSrc,style:{objectFit:this.objectFit}})]):h=Oe(s.default,k=>{if(k)return W(Ue,{onResize:this.fitTextTransform},{default:()=>W("span",{ref:"textRef",class:`${a}-avatar__text`},k)});if(u){const{imgProps:w}=this;return W("img",Object.assign(Object.assign({},w),{loading:ee&&!this.intersectionObserverOptions&&_?"lazy":"eager",src:ee||c||o?u:void 0,onLoad:d,"data-image-src":u,onError:this.handleError,style:[w==null?void 0:w.style,{objectFit:this.objectFit},p?{height:"0",width:"0",visibility:"hidden",position:"absolute"}:""]}))}}),W("span",{ref:"selfRef",class:[`${a}-avatar`,this.themeClass],style:this.cssVars},h,_&&p)}}),mt={class:"flex flex-col ml-4 flex-1 shrink-1 w-full"},ve=D({__name:"FollowItem",props:{pubkey:null,name:null,about:null},setup(r){const f=r,{pubkey:s,name:u,about:a}=N(f),[_,t]=Je(()=>ne(s.value)),d=v(()=>{var c;return(c=_.value)==null?void 0:c.feat.useMetadata()});return(c,o)=>{const b=_e,h=Ye;return g(),S(h,{class:"cursor-pointer overflow-hidden"},{default:i(()=>{var p,k,w;return[L("div",{ref_key:"target",ref:t,class:"flex items-center"},[l(b,{class:"ml-4",size:"small",src:(k=(p=e(d))==null?void 0:p.picture)!=null?k:e(ie),round:"",onClick:o[0]||(o[0]=()=>c.$router.push(`/profile/${e(s)}`))},null,8,["src"]),L("div",mt,[l(te,{class:"text-xl",onClick:o[1]||(o[1]=()=>c.$router.push(`/profile/${e(s)}`))},{default:i(()=>{var C,$,M;return[B(j((M=($=e(u))!=null?$:(C=e(d))==null?void 0:C.name)!=null?M:e(s).slice(0,10)),1)]}),_:1}),(w=e(d))!=null&&w.about?(g(),S(te,{key:0,style:{fontSize:"10px"}},{default:i(()=>{var C;return[B(j((C=e(a))!=null?C:e(d).about),1)]}),_:1})):U("",!0)])],512)]}),_:1})}}}),_t=D({__name:"Follow",props:{pubkey:null,urls:null,active:{type:Boolean}},setup(r){const f=r,{pubkey:s,urls:u,active:a}=N(f),_=v(()=>be(s.value,{urls:u==null?void 0:u.value})),t=v(()=>s.value===R.value.publicKey?q.getContactConfiguration():_.value.feat.getContactList()),d=z(void 0);return fe(d,{active:a}),(c,o)=>(g(),P("div",{ref_key:"divRef",ref:d,class:"p-4 box-border"},[l(e(me),null,{default:i(()=>[(g(!0),P(Y,null,pe(e(t),b=>(g(),S(ve,{key:b.pubkey,contact:b,pubkey:b.pubkey,name:b.name},null,8,["contact","pubkey","name"]))),128))]),_:1})],512))}}),vt=D({__name:"Follower",props:{pubkey:null,active:{type:Boolean},urls:null},setup(r){const f=r,{pubkey:s,active:u}=N(f),a=v(()=>ye(s.value)),_=v(()=>a.value.getList());Qe(a,u);const t=z(void 0);return fe(t,{active:Ie(f,"active")}),(d,c)=>(g(),P("div",{ref_key:"divRef",ref:t,class:"p-4 box-border"},[l(e(me),null,{default:i(()=>[(g(!0),P(Y,null,pe(e(_),o=>(g(),S(ve,{key:o.pubkey,pubkey:o.pubkey},null,8,["pubkey"]))),128))]),_:1})],512))}}),bt=D({__name:"ProfileMoreInfoRelayList",props:{pubkey:null,active:{type:Boolean}},setup(r){const f=r,{pubkey:s}=N(f),u=v(()=>ge(s.value)),a=v(()=>s.value===R.value.publicKey?{readUrl:I.getReadList(),writeUrl:I.getWriteList(),urls:new Set(Object.keys(I.getData()))}:u.value.feat.getReadWriteList()),_=v(()=>{var d;return(d=a.value)==null?void 0:d.urls});function t(){Ke.push({name:"relays"})}return(d,c)=>{var h;const o=A,b=he;return g(),P(Y,null,[l(b,{show:e(I).hasChange()},{default:i(()=>[l(o,{onClick:t,type:"primary"},{default:i(()=>[B(j(e(F)("save")),1)]),_:1})]),_:1},8,["show"]),l(ot,{urls:(h=e(_))!=null?h:[],title:""},{right:i(({url:p})=>{var k,w,C,$;return[l(nt,{active:(w=(k=e(a))==null?void 0:k.writeUrl.has(p))!=null?w:!1,class:"mr-1"},null,8,["active"]),l(at,{active:($=(C=e(a))==null?void 0:C.readUrl.has(p))!=null?$:!1,class:"mr-2"},null,8,["active"]),l(tt,{url:p},null,8,["url"])]}),_:1},8,["urls"])],64)}}}),yt=D({__name:"ProfileMoreInfo",props:{pubkey:null,urls:null},setup(r){const f=r,{pubkey:s}=N(f),u=v(()=>[s.value]),a=z("homepage");return(_,t)=>{const d=rt,c=lt;return g(),S(c,{type:"line",value:a.value,"onUpdate:value":t[0]||(t[0]=o=>a.value=o),animated:""},{default:i(()=>[l(d,{"display-directive":"show:lazy",name:"homepage",tab:e(F)("homepage")},{default:i(()=>[l(et,{active:a.value==="homepage",pubkeys:e(u),urls:f.urls},null,8,["active","pubkeys","urls"])]),_:1},8,["tab"]),l(d,{"display-directive":"show:lazy",name:"follow",tab:e(F)("follow")},{default:i(()=>[l(_t,{active:a.value==="follow",pubkey:e(s),urls:r.urls},null,8,["active","pubkey","urls"])]),_:1},8,["tab"]),l(d,{"display-directive":"show:lazy",name:"follower",tab:e(F)("follower")},{default:i(()=>[l(vt,{active:a.value==="follower",pubkey:e(s)},null,8,["active","pubkey"])]),_:1},8,["tab"]),l(d,{"display-directive":"show:lazy",name:"\u4E2D\u7EE7",tab:e(F)("relay")},{default:i(()=>[l(bt,{active:a.value==="relay",pubkey:e(s)},null,8,["active","pubkey"])]),_:1},8,["tab"])]),_:1},8,["value"])}}}),gt={},ht={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},kt=L("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44",d:"M358.62 129.28L86.49 402.08L70 442l39.92-16.49l272.8-272.13l-24.1-24.1z"},null,-1),wt=L("path",{d:"M413.07 74.84l-11.79 11.78l24.1 24.1l11.79-11.79a16.51 16.51 0 0 0 0-23.34l-.75-.75a16.51 16.51 0 0 0-23.35 0z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44"},null,-1),xt=[kt,wt];function Ft(r,f){return g(),P("svg",ht,xt)}const $t=ae(gt,[["render",Ft]]),Ct={},Et={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},zt=L("path",{d:"M384 336a63.78 63.78 0 0 0-46.12 19.7l-148-83.27a63.85 63.85 0 0 0 0-32.86l148-83.27a63.8 63.8 0 1 0-15.73-27.87l-148 83.27a64 64 0 1 0 0 88.6l148 83.27A64 64 0 1 0 384 336z",fill:"currentColor"},null,-1),Lt=[zt];function Bt(r,f){return g(),P("svg",Et,Lt)}const Rt=ae(Ct,[["render",Bt]]),St=D({__name:"UserDataEditing",emits:["close"],setup(r,{emit:f}){const s=Ve(),u=z({}),a=v(()=>ne(R.value.publicKey)),_=v(()=>a.value.feat.useMetadata());de(()=>{u.value=_.value});const t=z(!1);async function d(){t.value=!0,a.value.publish({content:JSON.stringify(u.value),kind:0},I.getWriteList(),{addUrl:!0,onOK({ok:c,url:o}){t.value=!1,c?s.success(`\u5DF2\u6210\u529F\u63D0\u4EA4\u5230${o}`):s.error(`\u63D0\u4EA4\u5230${o}\u5931\u8D25`)}})}return(c,o)=>{const b=Ae,h=Ne;return g(),S(h,{class:"w-[600px] max-w-full max-h-full",title:"\u7F16\u8F91\u7528\u6237\u4FE1\u606F",bordered:!1,role:"dialog","aria-modal":"true"},{default:i(()=>[l(e(oe),{vertical:""},{default:i(()=>[l(ut,{userMetadata:u.value},null,8,["userMetadata"]),l(e(oe),{center:""},{default:i(()=>[l(e(A),{type:"tertiary",onClick:o[0]||(o[0]=()=>f("close"))},{default:i(()=>[B(j(e(F)("cancel")),1)]),_:1}),l(b,{trigger:"hover"},{trigger:i(()=>[l(e(A),{type:"primary",onClick:d,loading:t.value,disabled:t.value},{default:i(()=>[B(j(e(F)("submit")),1)]),_:1},8,["loading","disabled"])]),default:i(()=>[B(" \u5982\u679C\u52A0\u8F7D\u4E0D\u5230\u5408\u9002\u7684\u4FE1\u606F\uFF0C\u90A3\u53EF\u80FD\u662Frelays\u8BBE\u7F6E\u4E0D\u5BF9\u8BF7\u5C1D\u8BD5\u914D\u7F6E\u4E00\u4E0B ")]),_:1}),t.value?(g(),S(b,{key:0,trigger:"hover"},{trigger:i(()=>[l(e(A),{onClick:o[1]||(o[1]=()=>t.value=!1)},{default:i(()=>[B("\u505C\u6B62\u52A0\u8F7D")]),_:1})]),default:i(()=>[B(" \u5982\u679C\u60A8\u662F\u65B0\u7528\u6237\u7684\u8BDD\uFF0C\u6216\u8005\u60A8\u653E\u5F03\u4E4B\u524D\u7684\u4FE1\u606F\u5C31\u53EF\u4EE5\u70B9\u6B64\u5904 ")]),_:1})):U("",!0)]),_:1})]),_:1})]),_:1})}}}),Pt=D({__name:"UserInformationButton",props:{pubkey:null},setup(r){const f=r,{pubkey:s}=N(f),u=st(),a=v(()=>s.value===R.value.publicKey),_=z(!1),t=ke(),d=we(),c=z([a.value&&{label:F("edit_user_profile"),key:"editProfile",icon:ue($t),props:{onclick(){_.value=!_.value}}},{label:F("copy"),key:"clipboard",icon:ue(Rt),children:[{label:`${F("copy")} npub`,key:"copy-npub",props:{onclick(){const o=X.npubEncode(R.value.publicKey);u(o)}}},{label:`${F("copy")} nprofile`,key:"copy-npro",props:{onclick(){const o=X.nprofileEncode({pubkey:R.value.publicKey,relays:[...I.getWriteList()]});u(o)}}},a.value&&{label:`${F("copy")} nsec`,key:"copy-nsec",props:{onclick(){const o=X.nsecEncode(R.value.privateKey);u(o)}}},{label:`${F("copy")} publicKey hex`,key:"copy-hex",props:{onclick(){u(R.value.publicKey)}}}].filter(o=>!!o)},{label:F("recommend_user"),key:"recommendUser",props:{onclick(){t(s.value)}}},{label:F("recommend_metadata"),key:"recommendUserMetadata",props:{onclick(){d(s.value)}}}].filter(o=>!!o));return(o,b)=>{const h=A,p=it,k=Te;return g(),P(Y,null,[l(p,{placement:"bottom-start",trigger:"click",options:c.value},{default:i(()=>[l(h,{circle:"",type:"info"},{default:i(()=>[l(xe)]),_:1})]),_:1},8,["options"]),l(k,{show:_.value,"onUpdate:show":b[1]||(b[1]=w=>_.value=w)},{default:i(()=>[l(St,{onClose:b[0]||(b[0]=()=>_.value=!1)})]),_:1},8,["show"])],64)}}}),Dt={key:0,class:"w-full h-full flex flex-col"},Mt={class:"flex flex-col"},jt={class:"flex items-center justify-end px-8 mt-4"},Ot={key:1},Ut={class:"flex items-center"},It={class:"w-full",style:{"word-break":"break-all","text-overflow":"ellipsis","word-wrap":"break-word"}},Kt=D({__name:"ProfileView",setup(r){const f=He(),s=X.nprofileEncode({pubkey:R.value.publicKey,relays:Array.from(I.getWriteList())}),u=v(()=>{var p;return(p=f.params.value)!=null?p:s}),a=v(()=>ct(u.value)),_=v(()=>{var p;return((p=a.value)==null?void 0:p.pubkey)===R.value.publicKey}),t=v(()=>{var p;return(p=a.value)==null?void 0:p.pubkey}),d=v(()=>{var p,k;return((p=a.value)==null?void 0:p.relays)&&new Set((k=a.value)==null?void 0:k.relays)}),c=v(()=>t.value?ne(t.value,{urls:d.value}).feat.useMetadata():null),o=v(()=>t.value?q.isFollow(t.value):!1);function b(){!t.value||(o.value?q.unFollow(t.value):q.follow(t.value))}const[h]=qe(.3);return(p,k)=>{const w=Ge,C=_e,$=A,M=oe;return e(t)?(g(),P("div",Dt,[l(Ze,{class:"flex-shrink flex-1 h-0",refreshable:"",loadable:""},{default:i(()=>{var T,n,m,x,y,E,K,O,V;return[L("div",Mt,[L("div",{ref_key:"target",ref:h,class:"h-0 w-full relative flex-shrink-0",style:{}},[((m=(T=e(c))==null?void 0:T.banner)!=null?m:(n=e(c))==null?void 0:n.picture)?(g(),S(w,{key:0,src:(E=(x=e(c))==null?void 0:x.banner)!=null?E:(y=e(c))==null?void 0:y.picture,"object-fit":"cover",class:"w-full h-full banner"},null,8,["src"])):U("",!0),l(C,{class:"absolute bottom-0 left-2",style:We({transform:"translate(0,50%)"}),round:"",size:100,src:(O=(K=e(c))==null?void 0:K.picture)!=null?O:e(ie)},null,8,["style","src"])],512),L("div",null,[L("div",jt,[l(M,null,{default:i(()=>[e(_)?U("",!0):(g(),S($,{key:0,class:"ml-4",strong:"",round:"",type:e(o)?"warning":"primary",onClick:b},{default:i(()=>[B(j(e(o)?"UnFollow":"Follow"),1)]),_:1},8,["type"])),e(t)?(g(),P("div",Ot,[l(Pt,{pubkey:e(t)},null,8,["pubkey"])])):U("",!0)]),_:1})]),L("h1",Ut,[l(te,null,{default:i(()=>{var H,G,J;return[B(j((J=(H=e(c))==null?void 0:H.name)!=null?J:(G=e(a))==null?void 0:G.pubkey.slice(0,10)),1)]}),_:1})]),L("div",It,j((V=e(c))==null?void 0:V.about),1)])]),e(t)?(g(),S(yt,{key:0,pubkey:e(t),urls:e(d)},null,8,["pubkey","urls"])):U("",!0)]}),_:1})])):U("",!0)}}});const Bo=ae(Kt,[["__scopeId","data-v-5fb6d0db"]]);export{Bo as default};
