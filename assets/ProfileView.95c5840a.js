import{g as re,c as A,a as ue}from"./Contact.69e9d033.js";import{a as ie,g as ee}from"./user.73c7c233.js";import{p as ce}from"./profile-2-400x400.23a9ef9d.js";import{E as pe}from"./Ellipsis.4f802c2a.js";import{f as B,av as F,bD as U,n as p,dj as V,y as _,I as g,H as o,A as n,L as N,J as te,C as e,z as $,aA as _e,f5 as me,D as x,F as P,dC as fe,at as E,db as de,_ as M,O as y,bA as I,aV as w,bz as ve,aM as ye,G as C,cr as ke,b3 as be,ar as R,cR as ge,bP as we,V as S,f6 as he,b2 as xe,Q as $e,da as Fe}from"./index.dd8c0757.js";import{g as oe,p as Ce}from"./use.b9e0cb1d.js";import{_ as ae,a as Ee}from"./FollowItem.vue_vue_type_script_setup_true_lang.bfab9d44.js";import{_ as ne}from"./ListItem.0c7d8888.js";import{u as Be,S as Le}from"./Scrollbar.206ae9b5.js";import{_ as De}from"./PostList.vue_vue_type_script_setup_true_lang.329f182f.js";import{a as Pe}from"./RelayAddButton.vue_vue_type_script_setup_true_lang.e3a6371b.js";import{a as Me}from"./AddButton.vue_vue_type_script_setup_true_lang.e6019b17.js";import{_ as Ue,a as Ae}from"./RelayWritableButton.vue_vue_type_script_setup_true_lang.7346cf6f.js";import{a as Re,i as Ve,j as Ne,k as Se}from"./Content.2b6a65a8.js";import{_ as ze,a as Ie}from"./Tabs.d1ce1b1d.js";import{u as je,r as Z}from"./naiveUi.4042f557.js";import{_ as Ke}from"./UserMetadataEditing.vue_vue_type_script_setup_true_lang.715a090f.js";import{_ as z}from"./Space.eeb4a7c6.js";import{_ as We}from"./Dropdown.87399565.js";import{b as Oe}from"./nostr.0c764f9a.js";import"./createGarbageFilter.58d83a26.js";import"./getCacheStaff.19f888e0.js";import"./autoAddRelayurlByEventIdStaff.2840aa6c.js";import"./Tag.5928ae9a.js";import"./ReloadCircleSharp.b8f1d9fd.js";import"./Icon.728af6b3.js";import"./Scrollbar.daa7bc26.js";import"./event.44d09d76.js";import"./PapawList.vue_vue_type_script_setup_true_lang.39874c13.js";import"./RelayInfoView.c41cbec3.js";import"./Empty.2444c71c.js";import"./use-theme-vars.314641c6.js";import"./Markdown.ab84075b.js";import"./MavonEditor.8712ed8c.js";import"./Drawer.vue_vue_type_script_setup_true_lang.cd23c256.js";import"./DrawerContent.cafeef9c.js";import"./ContentBlacklistView.52178d89.js";import"./Input.c0cbabec.js";import"./Popselect.b6cbd53c.js";import"./create.2deeaf6a.js";import"./Checkmark.5b25f79c.js";import"./VirtualList.072ef22a.js";import"./create-ref-setter.fe4a2903.js";import"./NaddrLink.vue_vue_type_script_setup_true_lang.6e72edd7.js";import"./UserLink.vue_vue_type_script_setup_true_lang.0306598a.js";import"./UploadButton.vue_vue_type_script_setup_true_lang.afb0c12a.js";import"./CloudUpload.7b2b77e1.js";import"./get-slot.4ceacf82.js";const Je=B({__name:"Follow",props:{pubkey:null,urls:null,active:{type:Boolean}},setup(k){const m=k,a=F(!1),{pubkey:l,urls:c,active:s}=U(m),r=p(()=>(a.value=!a.value,re(l.value,{urls:c==null?void 0:c.value}))),t=V(),b=p(()=>t.value?l.value===t.value?A.getContactConfiguration():r.value.feat.getContactList():[]),i=F(void 0);return oe(i,{active:s}),(v,u)=>(_(),g("div",{ref_key:"divRef",ref:i,class:"p-4 box-border"},[o(e(ne),null,{default:n(()=>[(_(!0),g(N,null,te(e(b),f=>(_(),$(ae,{key:f.pubkey,contact:f,pubkey:f.pubkey,name:f.name},null,8,["contact","pubkey","name"]))),128))]),_:1})],512))}}),Ge=B({__name:"Follower",props:{pubkey:null,active:{type:Boolean},urls:null},setup(k){const m=k,{pubkey:a,active:l}=U(m),c=p(()=>ue(a.value)),s=p(()=>c.value.getList());Be(c,l);const r=F(void 0);return oe(r,{active:_e(m,"active")}),(t,b)=>(_(),g("div",{ref_key:"divRef",ref:r,class:"p-4 box-border"},[o(e(ne),null,{default:n(()=>[(_(!0),g(N,null,te(e(s),i=>(_(),$(ae,{key:i.pubkey,pubkey:i.pubkey},null,8,["pubkey"]))),128))]),_:1})],512))}}),He=B({__name:"ProfileMoreInfoRelayList",props:{pubkey:null,active:{type:Boolean}},setup(k){const m=k,{pubkey:a}=U(m),l=p(()=>ie(a.value)),c=me(async()=>{var t;return a.value===((t=await fe())!=null?t:"")?{readUrl:E.getReadList(),writeUrl:E.getWriteList(),urls:new Set(Object.keys(E.getData()))}:l.value.feat.getReadWriteList()},void 0),s=p(()=>{var t;return(t=c.value)==null?void 0:t.urls});function r(){de.push({name:"relays"})}return(t,b)=>{var u;const i=M,v=Re;return _(),g(N,null,[o(v,{show:e(E).hasChange()},{default:n(()=>[o(i,{onClick:r,type:"primary"},{default:n(()=>[x(P(e(y)("save")),1)]),_:1})]),_:1},8,["show"]),o(Me,{urls:(u=e(s))!=null?u:[],title:""},{right:n(({url:f})=>{var d,h,L,D;return[o(Ue,{active:(h=(d=e(c))==null?void 0:d.writeUrl.has(f))!=null?h:!1,class:"mr-1"},null,8,["active"]),o(Ae,{active:(D=(L=e(c))==null?void 0:L.readUrl.has(f))!=null?D:!1,class:"mr-2"},null,8,["active"]),o(Pe,{url:f},null,8,["url"])]}),_:1},8,["urls"])],64)}}}),Qe=B({__name:"ProfileMoreInfo",props:{pubkey:null,urls:null},setup(k){const m=k,{pubkey:a}=U(m);p(()=>[a.value]);const l=F("homepage");return(c,s)=>{const r=ze,t=Ie;return _(),$(t,{type:"line",value:l.value,"onUpdate:value":s[0]||(s[0]=b=>l.value=b),animated:""},{default:n(()=>[o(r,{"display-directive":"show:lazy",name:"homepage",tab:e(y)("homepage")},{default:n(()=>[o(De,{active:l.value==="homepage",filters:[{kinds:[30023],authors:[e(a)]},{kinds:[1],authors:[e(a)]}],urls:m.urls},null,8,["active","filters","urls"])]),_:1},8,["tab"]),o(r,{"display-directive":"show:lazy",name:"follow",tab:e(y)("follow")},{default:n(()=>[o(Je,{active:l.value==="follow",pubkey:e(a),urls:k.urls},null,8,["active","pubkey","urls"])]),_:1},8,["tab"]),o(r,{"display-directive":"show:lazy",name:"follower",tab:e(y)("follower")},{default:n(()=>[o(Ge,{active:l.value==="follower",pubkey:e(a)},null,8,["active","pubkey"])]),_:1},8,["tab"]),o(r,{"display-directive":"show:lazy",name:"\u4E2D\u7EE7",tab:e(y)("relay")},{default:n(()=>[o(He,{active:l.value==="relay",pubkey:e(a)},null,8,["active","pubkey"])]),_:1},8,["tab"])]),_:1},8,["value"])}}}),Te={},qe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Xe=w("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44",d:"M358.62 129.28L86.49 402.08L70 442l39.92-16.49l272.8-272.13l-24.1-24.1z"},null,-1),Ye=w("path",{d:"M413.07 74.84l-11.79 11.78l24.1 24.1l11.79-11.79a16.51 16.51 0 0 0 0-23.34l-.75-.75a16.51 16.51 0 0 0-23.35 0z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44"},null,-1),Ze=[Xe,Ye];function et(k,m){return _(),g("svg",qe,Ze)}const tt=I(Te,[["render",et]]),ot={},at={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},nt=w("path",{d:"M384 336a63.78 63.78 0 0 0-46.12 19.7l-148-83.27a63.85 63.85 0 0 0 0-32.86l148-83.27a63.8 63.8 0 1 0-15.73-27.87l-148 83.27a64 64 0 1 0 0 88.6l148 83.27A64 64 0 1 0 384 336z",fill:"currentColor"},null,-1),lt=[nt];function st(k,m){return _(),g("svg",at,lt)}const rt=I(ot,[["render",st]]),ut=B({__name:"UserDataEditing",emits:["close"],setup(k,{emit:m}){const a=ve(),l=F({}),c=V({intercept:!0}),s=p(()=>{if(!!c.value)return ee(c.value)}),r=p(()=>s.value&&s.value.feat.useMetadata());ye(()=>{!r.value||(l.value=r.value)});const t=F(!1);async function b(){var i;t.value=!0,(i=s.value)==null||i.publish({content:JSON.stringify(l.value),kind:0},E.getWriteList(),{addUrl:!0,onOK({ok:v,url:u}){t.value=!1,v?a.success(`\u5DF2\u6210\u529F\u63D0\u4EA4\u5230${u}`):a.error(`\u63D0\u4EA4\u5230${u}\u5931\u8D25`)}})}return(i,v)=>{const u=ke,f=be;return e(s)?(_(),$(f,{key:0,class:"w-[600px] max-w-full max-h-full",title:"\u7F16\u8F91\u7528\u6237\u4FE1\u606F",bordered:!1,role:"dialog","aria-modal":"true"},{default:n(()=>[o(e(z),{vertical:""},{default:n(()=>[o(Ke,{userMetadata:l.value},null,8,["userMetadata"]),o(e(z),{center:""},{default:n(()=>[o(e(M),{type:"tertiary",onClick:v[0]||(v[0]=()=>m("close"))},{default:n(()=>[x(P(e(y)("cancel")),1)]),_:1}),o(u,{trigger:"hover"},{trigger:n(()=>[o(e(M),{type:"primary",onClick:b,loading:t.value,disabled:t.value},{default:n(()=>[x(P(e(y)("submit")),1)]),_:1},8,["loading","disabled"])]),default:n(()=>[x(" \u5982\u679C\u52A0\u8F7D\u4E0D\u5230\u5408\u9002\u7684\u4FE1\u606F\uFF0C\u90A3\u53EF\u80FD\u662Frelays\u8BBE\u7F6E\u4E0D\u5BF9\u8BF7\u5C1D\u8BD5\u914D\u7F6E\u4E00\u4E0B ")]),_:1}),t.value?(_(),$(u,{key:0,trigger:"hover"},{trigger:n(()=>[o(e(M),{onClick:v[1]||(v[1]=()=>t.value=!1)},{default:n(()=>[x("\u505C\u6B62\u52A0\u8F7D")]),_:1})]),default:n(()=>[x(" \u5982\u679C\u60A8\u662F\u65B0\u7528\u6237\u7684\u8BDD\uFF0C\u6216\u8005\u60A8\u653E\u5F03\u4E4B\u524D\u7684\u4FE1\u606F\u5C31\u53EF\u4EE5\u70B9\u6B64\u5904 ")]),_:1})):C("",!0)]),_:1})]),_:1})]),_:1})):C("",!0)}}}),it=B({__name:"UserInformationButton",props:{pubkey:null},setup(k){var v;const m=k,{pubkey:a}=U(m),l=je(),c=V(),s=p(()=>a.value===c.value),r=F(!1),t=Ve(),b=Ne(),i=F([s.value&&{label:y("edit_user_profile"),key:"editProfile",icon:Z(tt),props:{onclick(){r.value=!r.value}}},{label:y("copy"),key:"clipboard",icon:Z(rt),children:[{label:`${y("copy")} npub`,key:"copy-npub",props:{onclick(){const u=R.npubEncode(a.value);l(u)}}},{label:`${y("copy")} nprofile`,key:"copy-npro",props:{onclick(){const u=R.nprofileEncode({pubkey:a.value,relays:[...E.getWriteList()]});l(u)}}},s.value&&ge()===we.PrivateKey&&((v=S)==null?void 0:v.getPrivateKey)&&typeof S.getPrivateKey=="function"&&{label:`${y("copy")} nsec`,key:"copy-nsec",props:{onclick(){const u=R.nsecEncode(S.getPrivateKey());l(u)}}},{label:`${y("copy")} publicKey hex`,key:"copy-hex",props:{onclick(){l(a.value)}}}].filter(u=>!!u)},{label:y("recommend_user"),key:"recommendUser",props:{onclick(){t(a.value)}}},{label:y("recommend_metadata"),key:"recommendUserMetadata",props:{onclick(){b(a.value)}}}].filter(u=>!!u));return(u,f)=>{const d=M,h=We,L=he;return _(),g(N,null,[o(h,{placement:"bottom-start",trigger:"click",options:i.value},{default:n(()=>[o(d,{circle:"",type:"info"},{default:n(()=>[o(Se)]),_:1})]),_:1},8,["options"]),o(L,{show:r.value,"onUpdate:show":f[1]||(f[1]=D=>r.value=D)},{default:n(()=>[o(ut,{onClose:f[0]||(f[0]=()=>r.value=!1)})]),_:1},8,["show"])],64)}}}),ct={key:0,class:"w-full h-full flex flex-col"},pt={class:"flex flex-col"},_t={class:"flex items-center justify-end px-8 mt-4"},mt={key:1},ft={class:"flex items-center"},dt={class:"w-full",style:{"word-break":"break-all","text-overflow":"ellipsis","word-wrap":"break-word"}},vt=B({__name:"ProfileView",setup(k){const m=$e(),a=V({intercept:!0}),l=p(()=>a.value?R.nprofileEncode({pubkey:a.value,relays:Array.from(E.getWriteList())}):""),c=p(()=>{var d;return(d=m.params.value)!=null?d:l.value}),s=p(()=>Oe(c.value)),r=p(()=>{var d;return((d=s.value)==null?void 0:d.pubkey)===a.value}),t=p(()=>{var d;return(d=s.value)==null?void 0:d.pubkey}),b=p(()=>{var d,h;return((d=s.value)==null?void 0:d.relays)&&new Set((h=s.value)==null?void 0:h.relays)}),i=p(()=>t.value?ee(t.value,{urls:b.value}).feat.useMetadata():null),v=p(()=>t.value?A.isFollow(t.value):!1);async function u(){!t.value||(v.value?await A.unFollow(t.value):await A.follow(t.value))}const[f]=Ce(.3);return(d,h)=>{const L=Fe,D=Ee,le=M,se=z;return e(t)?(_(),g("div",ct,[o(Le,{class:"flex-shrink flex-1 h-0",refreshable:"",loadable:""},{default:n(()=>{var j,K,W,O,J,G,H,Q,T;return[w("div",pt,[w("div",{ref_key:"target",ref:f,class:"h-0 w-full relative flex-shrink-0",style:{}},[((W=(j=e(i))==null?void 0:j.banner)!=null?W:(K=e(i))==null?void 0:K.picture)?(_(),$(L,{key:0,src:(G=(O=e(i))==null?void 0:O.banner)!=null?G:(J=e(i))==null?void 0:J.picture,"object-fit":"cover",class:"w-full h-full banner"},null,8,["src"])):C("",!0),o(D,{class:"absolute bottom-0 left-2",style:xe({transform:"translate(0,50%)"}),round:"",size:100,src:(Q=(H=e(i))==null?void 0:H.picture)!=null?Q:e(ce)},null,8,["style","src"])],512),w("div",null,[w("div",_t,[o(se,null,{default:n(()=>[e(r)?C("",!0):(_(),$(le,{key:0,class:"ml-4",strong:"",round:"",type:e(v)?"warning":"primary",onClick:u},{default:n(()=>[x(P(e(v)?"UnFollow":"Follow"),1)]),_:1},8,["type"])),e(t)?(_(),g("div",mt,[o(it,{pubkey:e(t)},null,8,["pubkey"])])):C("",!0)]),_:1})]),w("h1",ft,[o(pe,null,{default:n(()=>{var q,X,Y;return[x(P((Y=(q=e(i))==null?void 0:q.name)!=null?Y:(X=e(s))==null?void 0:X.pubkey.slice(0,10)),1)]}),_:1})]),w("div",dt,P((T=e(i))==null?void 0:T.about),1)])]),e(t)?(_(),$(Qe,{key:0,pubkey:e(t),urls:e(b)},null,8,["pubkey","urls"])):C("",!0)]}),_:1})])):C("",!0)}}});const po=I(vt,[["__scopeId","data-v-44199ace"]]);export{po as default};
