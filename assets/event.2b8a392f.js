import{a2 as i,a3 as r,a4 as f,a5 as u,Y as d,ai as o,Z as y,an as m,a0 as h,V as b,ao as g,ab as w}from"./index.d72ecaa3.js";import{c as s,d as c,h as B,b as l}from"./getCacheStaff.c38799cf.js";import{c as k}from"./autoAddRelayurlByEventIdStaff.81d588be.js";async function L(a,e,t){return new Promise((n,v)=>{const S=h({kind:5,pubkey:b.value.publicKey,tags:a.map(E=>["e",E])});d.createChild().publish(S,g(w.getWriteList(),e!=null?e:new Set),t)})}function A(a,e){L([a],e==null?void 0:e.urls,e)}function D(a,e){return i("getEventLineById"+a,()=>{const t=r({describe:"\u83B7\u53D6Event\u901A\u8FC7id"}).addFilter({ids:[a],limit:1}).addStaff(k()).addStaff(s()).addStaff(c()).addStaff(f()).addStaff(u());if(t.addStaff(B(a)),t.feat.withEvent()||(t.addExtends(d),t.feat.withEvent()))return t;const n=async()=>{(e==null?void 0:e.urls)&&e.urls.size>0&&(t.addRelayUrls(e.urls),await t.feat.timeoutWithEvent())||e!=null&&e.pubkey&&(t.addStaff(l(e.pubkey)),await t.feat.timeoutWithEvent())||(t.addReadUrl(),await t.feat.timeoutWithEvent())};return o(`getEventLineById:${a}`,()=>{n()},20*1e3),t},{useLocalStorage:!1})}function F(a,e){return i(`createGetEventLineByAddressPointer:${m.naddrEncode(a)}`,()=>{const t={["#d"]:[a.identifier],authors:[a.pubkey],kinds:[a.kind]},n=r({describe:"\u83B7\u53D6Event\u901A\u8FC7id"}).addFilter(t).addStaff(s()).addStaff(y()).addStaff(c()).addStaff(f()).addStaff(u());return(async()=>{n.addStaff(l(a.pubkey)),!await n.feat.timeoutWithEvent()&&((e==null?void 0:e.urls)&&e.urls.size>0&&(n.addRelayUrls(e.urls),await n.feat.timeoutWithEvent())||(n.addReadUrl(),await n.feat.timeoutWithEvent()))})(),n},{useLocalStorage:!1})}export{F as c,A as e,D as g};
