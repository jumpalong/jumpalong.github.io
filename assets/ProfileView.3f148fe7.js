import{g as re,c as A,a as ue}from"./Contact.3691bc57.js";import{a as ie,g as ee}from"./user.2315a04a.js";import{p as ce}from"./profile-2-400x400.cb17258a.js";import{E as pe}from"./Ellipsis.94252284.js";import{f as B,aq as F,bw as U,n as p,da as N,y as _,I as g,H as o,A as n,L as S,J as te,C as e,z as $,av as _e,eZ as me,D as x,F as P,dt as fe,ab as E,d4 as de,_ as M,O as y,bt as I,aQ as w,bs as ve,aH as ye,G as C,ck as ke,a_ as be,ao as R,cK as ge,bI as we,V,e_ as he,aZ as xe,Q as $e,d3 as Fe}from"./index.2c9351ad.js";import{g as oe,p as Ce}from"./use.ae81dab7.js";import{_ as ae,a as Ee}from"./FollowItem.vue_vue_type_script_setup_true_lang.b932b6e3.js";import{_ as ne}from"./ListItem.fcb6ad9c.js";import{u as Be,S as Le}from"./Scrollbar.7ad14a42.js";import{_ as De}from"./PostList.vue_vue_type_script_setup_true_lang.e46a5363.js";import{a as Pe}from"./RelayAddButton.vue_vue_type_script_setup_true_lang.33eda429.js";import{a as Me}from"./AddButton.vue_vue_type_script_setup_true_lang.372490c1.js";import{_ as Ue,a as Ae}from"./RelayWritableButton.vue_vue_type_script_setup_true_lang.106482cb.js";import{a as Re,i as Ne,j as Se,k as Ve}from"./Content.f582cac5.js";import{_ as ze,a as Ie}from"./Tabs.11e47fa1.js";import{u as Ke,r as Y}from"./naiveUi.a1050533.js";import{_ as je}from"./UserMetadataEditing.vue_vue_type_script_setup_true_lang.9825be27.js";import{_ as z}from"./Space.f5cd30b1.js";import{_ as We}from"./Dropdown.03e2b018.js";import{b as Oe}from"./nostr.05930688.js";import"./getCacheStaff.7425a190.js";import"./createGarbageFilter.8427473b.js";import"./autoAddRelayurlByEventIdStaff.43660d1b.js";import"./Tag.9aafc5b2.js";import"./ReloadCircleSharp.61db258d.js";import"./Icon.6675cd7a.js";import"./Scrollbar.c784e096.js";import"./event.4b7b2eec.js";import"./PapawList.vue_vue_type_script_setup_true_lang.4077012e.js";import"./RelayInfoView.4f891fda.js";import"./Empty.35e208e2.js";import"./use-theme-vars.ccd9082d.js";import"./Markdown.c7f5654d.js";import"./MavonEditor.822311d9.js";import"./Drawer.vue_vue_type_script_setup_true_lang.7e57006f.js";import"./DrawerContent.d3f9a524.js";import"./ContentBlacklistView.4608e144.js";import"./Input.9da139e0.js";import"./Popselect.d00ebf8a.js";import"./create.2deeaf6a.js";import"./Checkmark.647add68.js";import"./VirtualList.5212fd16.js";import"./create-ref-setter.fe4a2903.js";import"./NaddrLink.vue_vue_type_script_setup_true_lang.9594c6bb.js";import"./UserLink.vue_vue_type_script_setup_true_lang.7f74740d.js";import"./UploadButton.vue_vue_type_script_setup_true_lang.4c292853.js";import"./CloudUpload.dc24dd7a.js";import"./get-slot.4ceacf82.js";const He=B({__name:"Follow",props:{pubkey:null,urls:null,active:{type:Boolean}},setup(k){const m=k,a=F(!1),{pubkey:l,urls:c,active:s}=U(m),r=p(()=>(a.value=!a.value,re(l.value,{urls:c==null?void 0:c.value}))),t=N(),b=p(()=>t.value?l.value===t.value?A.getContactConfiguration():r.value.feat.getContactList():[]),i=F(void 0);return oe(i,{active:s}),(v,u)=>(_(),g("div",{ref_key:"divRef",ref:i,class:"p-4 box-border"},[o(e(ne),null,{default:n(()=>[(_(!0),g(S,null,te(e(b),f=>(_(),$(ae,{key:f.pubkey,contact:f,pubkey:f.pubkey,name:f.name},null,8,["contact","pubkey","name"]))),128))]),_:1})],512))}}),Je=B({__name:"Follower",props:{pubkey:null,active:{type:Boolean},urls:null},setup(k){const m=k,{pubkey:a,active:l}=U(m),c=p(()=>ue(a.value)),s=p(()=>c.value.getList());Be(c,l);const r=F(void 0);return oe(r,{active:_e(m,"active")}),(t,b)=>(_(),g("div",{ref_key:"divRef",ref:r,class:"p-4 box-border"},[o(e(ne),null,{default:n(()=>[(_(!0),g(S,null,te(e(s),i=>(_(),$(ae,{key:i.pubkey,pubkey:i.pubkey},null,8,["pubkey"]))),128))]),_:1})],512))}}),Qe=B({__name:"ProfileMoreInfoRelayList",props:{pubkey:null,active:{type:Boolean}},setup(k){const m=k,{pubkey:a}=U(m),l=p(()=>ie(a.value)),c=me(async()=>{var t;return a.value===((t=await fe())!=null?t:"")?{readUrl:E.getReadList(),writeUrl:E.getWriteList(),urls:new Set(Object.keys(E.getData()))}:l.value.feat.getReadWriteList()},void 0),s=p(()=>{var t;return(t=c.value)==null?void 0:t.urls});function r(){de.push({name:"relays"})}return(t,b)=>{var u;const i=M,v=Re;return _(),g(S,null,[o(v,{show:e(E).hasChange()},{default:n(()=>[o(i,{onClick:r,type:"primary"},{default:n(()=>[x(P(e(y)("save")),1)]),_:1})]),_:1},8,["show"]),o(Me,{urls:(u=e(s))!=null?u:[],title:""},{right:n(({url:f})=>{var d,h,L,D;return[o(Ue,{active:(h=(d=e(c))==null?void 0:d.writeUrl.has(f))!=null?h:!1,class:"mr-1"},null,8,["active"]),o(Ae,{active:(D=(L=e(c))==null?void 0:L.readUrl.has(f))!=null?D:!1,class:"mr-2"},null,8,["active"]),o(Pe,{url:f},null,8,["url"])]}),_:1},8,["urls"])],64)}}}),Ze=B({__name:"ProfileMoreInfo",props:{pubkey:null,urls:null},setup(k){const m=k,{pubkey:a}=U(m);p(()=>[a.value]);const l=F("homepage");return(c,s)=>{const r=ze,t=Ie;return _(),$(t,{type:"line",value:l.value,"onUpdate:value":s[0]||(s[0]=b=>l.value=b),animated:""},{default:n(()=>[o(r,{"display-directive":"show:lazy",name:"homepage",tab:e(y)("homepage")},{default:n(()=>[o(De,{active:l.value==="homepage",filters:[{kinds:[30023],authors:[e(a)]},{kinds:[1],authors:[e(a)]}],urls:m.urls},null,8,["active","filters","urls"])]),_:1},8,["tab"]),o(r,{"display-directive":"show:lazy",name:"follow",tab:e(y)("follow")},{default:n(()=>[o(He,{active:l.value==="follow",pubkey:e(a),urls:k.urls},null,8,["active","pubkey","urls"])]),_:1},8,["tab"]),o(r,{"display-directive":"show:lazy",name:"follower",tab:e(y)("follower")},{default:n(()=>[o(Je,{active:l.value==="follower",pubkey:e(a)},null,8,["active","pubkey"])]),_:1},8,["tab"]),o(r,{"display-directive":"show:lazy",name:"\u4E2D\u7EE7",tab:e(y)("relay")},{default:n(()=>[o(Qe,{active:l.value==="relay",pubkey:e(a)},null,8,["active","pubkey"])]),_:1},8,["tab"])]),_:1},8,["value"])}}}),qe={},Ge={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Te=w("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44",d:"M358.62 129.28L86.49 402.08L70 442l39.92-16.49l272.8-272.13l-24.1-24.1z"},null,-1),Xe=w("path",{d:"M413.07 74.84l-11.79 11.78l24.1 24.1l11.79-11.79a16.51 16.51 0 0 0 0-23.34l-.75-.75a16.51 16.51 0 0 0-23.35 0z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44"},null,-1),Ye=[Te,Xe];function et(k,m){return _(),g("svg",Ge,Ye)}const tt=I(qe,[["render",et]]),ot={},at={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},nt=w("path",{d:"M384 336a63.78 63.78 0 0 0-46.12 19.7l-148-83.27a63.85 63.85 0 0 0 0-32.86l148-83.27a63.8 63.8 0 1 0-15.73-27.87l-148 83.27a64 64 0 1 0 0 88.6l148 83.27A64 64 0 1 0 384 336z",fill:"currentColor"},null,-1),lt=[nt];function st(k,m){return _(),g("svg",at,lt)}const rt=I(ot,[["render",st]]),ut=B({__name:"UserDataEditing",emits:["close"],setup(k,{emit:m}){const a=ve(),l=F({}),c=N({intercept:!0}),s=p(()=>{if(!!c.value)return ee(c.value)}),r=p(()=>s.value&&s.value.feat.useMetadata());ye(()=>{!r.value||(l.value=r.value)});const t=F(!1);async function b(){var i;t.value=!0,(i=s.value)==null||i.publish({content:JSON.stringify(l.value),kind:0},E.getWriteList(),{addUrl:!0,onOK({ok:v,url:u}){t.value=!1,v?a.success(`\u5DF2\u6210\u529F\u63D0\u4EA4\u5230${u}`):a.error(`\u63D0\u4EA4\u5230${u}\u5931\u8D25`)}})}return(i,v)=>{const u=ke,f=be;return e(s)?(_(),$(f,{key:0,class:"w-[600px] max-w-full max-h-full",title:"\u7F16\u8F91\u7528\u6237\u4FE1\u606F",bordered:!1,role:"dialog","aria-modal":"true"},{default:n(()=>[o(e(z),{vertical:""},{default:n(()=>[o(je,{userMetadata:l.value},null,8,["userMetadata"]),o(e(z),{center:""},{default:n(()=>[o(e(M),{type:"tertiary",onClick:v[0]||(v[0]=()=>m("close"))},{default:n(()=>[x(P(e(y)("cancel")),1)]),_:1}),o(u,{trigger:"hover"},{trigger:n(()=>[o(e(M),{type:"primary",onClick:b,loading:t.value,disabled:t.value},{default:n(()=>[x(P(e(y)("submit")),1)]),_:1},8,["loading","disabled"])]),default:n(()=>[x(" \u5982\u679C\u52A0\u8F7D\u4E0D\u5230\u5408\u9002\u7684\u4FE1\u606F\uFF0C\u90A3\u53EF\u80FD\u662Frelays\u8BBE\u7F6E\u4E0D\u5BF9\u8BF7\u5C1D\u8BD5\u914D\u7F6E\u4E00\u4E0B ")]),_:1}),t.value?(_(),$(u,{key:0,trigger:"hover"},{trigger:n(()=>[o(e(M),{onClick:v[1]||(v[1]=()=>t.value=!1)},{default:n(()=>[x("\u505C\u6B62\u52A0\u8F7D")]),_:1})]),default:n(()=>[x(" \u5982\u679C\u60A8\u662F\u65B0\u7528\u6237\u7684\u8BDD\uFF0C\u6216\u8005\u60A8\u653E\u5F03\u4E4B\u524D\u7684\u4FE1\u606F\u5C31\u53EF\u4EE5\u70B9\u6B64\u5904 ")]),_:1})):C("",!0)]),_:1})]),_:1})]),_:1})):C("",!0)}}}),it=B({__name:"UserInformationButton",props:{pubkey:null},setup(k){var v;const m=k,{pubkey:a}=U(m),l=Ke(),c=N(),s=p(()=>a.value===c.value),r=F(!1),t=Ne(),b=Se(),i=F([s.value&&{label:y("edit_user_profile"),key:"editProfile",icon:Y(tt),props:{onclick(){r.value=!r.value}}},{label:y("copy"),key:"clipboard",icon:Y(rt),children:[{label:`${y("copy")} npub`,key:"copy-npub",props:{onclick(){const u=R.npubEncode(a.value);l(u)}}},{label:`${y("copy")} nprofile`,key:"copy-npro",props:{onclick(){const u=R.nprofileEncode({pubkey:a.value,relays:[...E.getWriteList()]});l(u)}}},s.value&&ge()===we.PrivateKey&&((v=V)==null?void 0:v.getPrivateKey)&&typeof V.getPrivateKey=="function"&&{label:`${y("copy")} nsec`,key:"copy-nsec",props:{onclick(){const u=R.nsecEncode(V.getPrivateKey());l(u)}}},{label:`${y("copy")} publicKey hex`,key:"copy-hex",props:{onclick(){l(a.value)}}}].filter(u=>!!u)},{label:y("recommend_user"),key:"recommendUser",props:{onclick(){t(a.value)}}},{label:y("recommend_metadata"),key:"recommendUserMetadata",props:{onclick(){b(a.value)}}}].filter(u=>!!u));return(u,f)=>{const d=M,h=We,L=he;return _(),g(S,null,[o(h,{placement:"bottom-start",trigger:"click",options:i.value},{default:n(()=>[o(d,{circle:"",type:"info"},{default:n(()=>[o(Ve)]),_:1})]),_:1},8,["options"]),o(L,{show:r.value,"onUpdate:show":f[1]||(f[1]=D=>r.value=D)},{default:n(()=>[o(ut,{onClose:f[0]||(f[0]=()=>r.value=!1)})]),_:1},8,["show"])],64)}}}),ct={key:0,class:"w-full h-full flex flex-col"},pt={class:"flex flex-col"},_t={class:"flex items-center justify-end px-8 mt-4"},mt={key:1},ft={class:"flex items-center"},dt={class:"w-full",style:{"word-break":"break-all","text-overflow":"ellipsis","word-wrap":"break-word"}},vt=B({__name:"ProfileView",setup(k){const m=$e(),a=N({intercept:!0}),l=p(()=>a.value?R.nprofileEncode({pubkey:a.value,relays:Array.from(E.getWriteList())}):""),c=p(()=>{var d;return(d=m.params.value)!=null?d:l.value}),s=p(()=>Oe(c.value)),r=p(()=>{var d;return((d=s.value)==null?void 0:d.pubkey)===a.value}),t=p(()=>{var d;return(d=s.value)==null?void 0:d.pubkey}),b=p(()=>{var d,h;return((d=s.value)==null?void 0:d.relays)&&new Set((h=s.value)==null?void 0:h.relays)}),i=p(()=>t.value?ee(t.value,{urls:b.value}).feat.useMetadata():null),v=p(()=>t.value?A.isFollow(t.value):!1);async function u(){!t.value||(v.value?await A.unFollow(t.value):await A.follow(t.value))}const[f]=Ce(.3);return(d,h)=>{const L=Fe,D=Ee,le=M,se=z;return e(t)?(_(),g("div",ct,[o(Le,{class:"flex-shrink flex-1 h-0",refreshable:"",loadable:""},{default:n(()=>{var K,j,W,O,H,J,Q,Z,q;return[w("div",pt,[w("div",{ref_key:"target",ref:f,class:"h-0 w-full relative flex-shrink-0",style:{}},[((W=(K=e(i))==null?void 0:K.banner)!=null?W:(j=e(i))==null?void 0:j.picture)?(_(),$(L,{key:0,src:(J=(O=e(i))==null?void 0:O.banner)!=null?J:(H=e(i))==null?void 0:H.picture,"object-fit":"cover",class:"w-full h-full banner"},null,8,["src"])):C("",!0),o(D,{class:"absolute bottom-0 left-2",style:xe({transform:"translate(0,50%)"}),round:"",size:100,src:(Z=(Q=e(i))==null?void 0:Q.picture)!=null?Z:e(ce)},null,8,["style","src"])],512),w("div",null,[w("div",_t,[o(se,null,{default:n(()=>[e(r)?C("",!0):(_(),$(le,{key:0,class:"ml-4",strong:"",round:"",type:e(v)?"warning":"primary",onClick:u},{default:n(()=>[x(P(e(v)?"UnFollow":"Follow"),1)]),_:1},8,["type"])),e(t)?(_(),g("div",mt,[o(it,{pubkey:e(t)},null,8,["pubkey"])])):C("",!0)]),_:1})]),w("h1",ft,[o(pe,null,{default:n(()=>{var G,T,X;return[x(P((X=(G=e(i))==null?void 0:G.name)!=null?X:(T=e(s))==null?void 0:T.pubkey.slice(0,10)),1)]}),_:1})]),w("div",dt,P((q=e(i))==null?void 0:q.about),1)])]),e(t)?(_(),$(Ze,{key:0,pubkey:e(t),urls:e(b)},null,8,["pubkey","urls"])):C("",!0)]}),_:1})])):C("",!0)}}});const po=I(vt,[["__scopeId","data-v-44199ace"]]);export{po as default};
