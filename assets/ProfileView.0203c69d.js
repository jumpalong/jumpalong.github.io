import{g as ve,c as J,a as be}from"./Contact.4a2bc291.js";import{g as oe,a as ye}from"./user.4e76e6df.js";import{p as ue,a as he,i as ge,j as ke,k as we}from"./Content.abdb10db.js";import{E as ie}from"./Ellipsis.b41ee5fc.js";import{l as xe,c as ae,cq as $e,b as Z,cr as Fe,d as re,f as M,u as Ce,aq as z,m as le,n as v,h as ce,dk as Ee,ax as Le,o as ze,q as Be,dh as Re,aF as Se,dl as ee,aH as de,dm as Pe,b5 as Me,w as De,v as je,j as W,aK as Oe,bw as T,y,z as R,A as c,aQ as E,H as s,C as e,F as O,D as P,G as K,I as S,L as X,J as pe,V as B,aa as I,di as Ue,_ as N,O as $,bt as ne,bs as Ke,c6 as Ie,a_ as Ve,bK as Q,dn as Ae,aZ as Ne,Q as Te,d2 as We}from"./index.70f8884a.js";import{l as He,p as Ge}from"./use.649125ec.js";import{t as qe}from"./Tag.46089e63.js";import{a as Je,_ as fe}from"./ListItem.34301ac7.js";import{u as Qe,S as Xe}from"./Scrollbar.0f77d236.js";import{_ as Ye}from"./PostList.vue_vue_type_script_setup_true_lang.19cb7210.js";import{a as Ze}from"./RelayAddButton.vue_vue_type_script_setup_true_lang.fa658e44.js";import{a as et}from"./AddButton.vue_vue_type_script_setup_true_lang.1818efac.js";import{_ as tt,a as ot}from"./RelayWritableButton.vue_vue_type_script_setup_true_lang.adece871.js";import{_ as nt,a as at}from"./Tabs.e26af0f5.js";import{u as rt,r as se}from"./naiveUi.0feadf26.js";import{_ as lt}from"./UserMetadataEditing.vue_vue_type_script_setup_true_lang.3deba5c5.js";import{_ as te}from"./Space.7a03ce87.js";import{_ as st}from"./Dropdown.50aac763.js";import{a as ut}from"./nostr.07794609.js";import"./getCacheStaff.3d60947c.js";import"./event.271d9567.js";import"./autoAddRelayurlByEventIdStaff.6030713a.js";import"./channel.9cf5f620.js";import"./ContentBlacklistView.76efa451.js";import"./Input.c72c1027.js";import"./Icon.76b8c9c6.js";import"./UserLink.vue_vue_type_script_setup_true_lang.9b7944e9.js";import"./DrawerContent.5919c25b.js";import"./RelayInfoView.f4ee9799.js";import"./use-theme-vars.c8b8e495.js";import"./Popselect.e3982e97.js";import"./create.2deeaf6a.js";import"./Checkmark.33c23f48.js";import"./Empty.0100d8e4.js";import"./create-ref-setter.fe4a2903.js";import"./Scrollbar.aca2cd5d.js";import"./PapawList.vue_vue_type_script_setup_true_lang.670fc5e9.js";import"./composables.43b0b4c0.js";import"./UploadButton.vue_vue_type_script_setup_true_lang.0e041b26.js";import"./CloudUpload.01bd21cd.js";import"./get-slot.4ceacf82.js";const it=xe("n-avatar-group"),ct=ae("avatar",`
 width: var(--n-merged-size);
 height: var(--n-merged-size);
 color: #FFF;
 font-size: var(--n-font-size);
 display: inline-flex;
 position: relative;
 overflow: hidden;
 text-align: center;
 border: var(--n-border);
 border-radius: var(--n-border-radius);
 --n-merged-color: var(--n-color);
 background-color: var(--n-merged-color);
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
`,[$e(Z("&","--n-merged-color: var(--n-color-modal);")),Fe(Z("&","--n-merged-color: var(--n-color-popover);")),Z("img",`
 width: 100%;
 height: 100%;
 `),re("text",`
 white-space: nowrap;
 display: inline-block;
 position: absolute;
 left: 50%;
 top: 50%;
 `),ae("icon",`
 vertical-align: bottom;
 font-size: calc(var(--n-merged-size) - 6px);
 `),re("text","line-height: 1.25")]),dt=Object.assign(Object.assign({},ce.props),{size:[String,Number],src:String,circle:{type:Boolean,default:void 0},objectFit:String,round:{type:Boolean,default:void 0},bordered:{type:Boolean,default:void 0},onError:Function,fallbackSrc:String,intersectionObserverOptions:Object,lazy:Boolean,onLoad:Function,renderPlaceholder:Function,renderFallback:Function,imgProps:Object,color:String}),_e=M({name:"Avatar",props:dt,setup(r){const{mergedClsPrefixRef:f,inlineThemeDisabled:u}=Ce(r),i=z(!1);let a=null;const m=z(null),o=z(null),p=()=>{const{value:t}=m;if(t&&(a===null||a!==t.innerHTML)){a=t.innerHTML;const{value:_}=o;if(_){const{offsetWidth:x,offsetHeight:b}=_,{offsetWidth:C,offsetHeight:V}=t,U=.9,A=Math.min(x/C*U,b/V*U,1);t.style.transform=`translateX(-50%) translateY(-50%) scale(${A})`}}},l=le(it,null),n=v(()=>{const{size:t}=r;if(t)return t;const{size:_}=l||{};return _||"medium"}),h=ce("Avatar","-avatar",ct,Ee,r,f),g=le(qe,null),d=v(()=>{if(l)return!0;const{round:t,circle:_}=r;return t!==void 0||_!==void 0?t||_:g?g.roundRef.value:!1}),k=v(()=>l?!0:r.bordered||!1),w=t=>{var _;if(!D.value)return;i.value=!0;const{onError:x,imgProps:b}=r;(_=b==null?void 0:b.onError)===null||_===void 0||_.call(b,t),x&&x(t)};Le(()=>r.src,()=>i.value=!1);const L=v(()=>{const t=n.value,_=d.value,x=k.value,{color:b}=r,{self:{borderRadius:C,fontSize:V,color:U,border:A,colorModal:H,colorPopover:G},common:{cubicBezierEaseInOut:q}}=h.value;let Y;return typeof t=="number"?Y=`${t}px`:Y=h.value.self[ze("height",t)],{"--n-font-size":V,"--n-border":x?A:"none","--n-border-radius":_?"50%":C,"--n-color":b||U,"--n-color-modal":b||H,"--n-color-popover":b||G,"--n-bezier":q,"--n-merged-size":`var(--n-avatar-size-override, ${Y})`}}),F=u?Be("avatar",v(()=>{const t=n.value,_=d.value,x=k.value,{color:b}=r;let C="";return t&&(typeof t=="number"?C+=`a${t}`:C+=t[0]),_&&(C+="b"),x&&(C+="c"),b&&(C+=Re(b)),C}),L,r):void 0,D=z(!r.lazy);Se(()=>{if(ee)return;let t;const _=de(()=>{t==null||t(),t=void 0,r.lazy&&(t=Pe(o.value,r.intersectionObserverOptions,D))});Me(()=>{_(),t==null||t()})});const j=z(!r.lazy);return{textRef:m,selfRef:o,mergedRoundRef:d,mergedClsPrefix:f,fitTextTransform:p,cssVars:u?void 0:L,themeClass:F==null?void 0:F.themeClass,onRender:F==null?void 0:F.onRender,hasLoadError:i,handleError:w,shouldStartLoading:D,loaded:j,mergedOnLoad:t=>{var _;const{onLoad:x,imgProps:b}=r;x==null||x(t),(_=b==null?void 0:b.onLoad)===null||_===void 0||_.call(b,t),j.value=!0}}},render(){var r,f;const{$slots:u,src:i,mergedClsPrefix:a,lazy:m,onRender:o,mergedOnLoad:p,shouldStartLoading:l,loaded:n,hasLoadError:h}=this;o==null||o();let g;const d=!n&&!h&&(this.renderPlaceholder?this.renderPlaceholder():(f=(r=this.$slots).placeholder)===null||f===void 0?void 0:f.call(r));return this.hasLoadError?g=this.renderFallback?this.renderFallback():De(u.fallback,()=>[W("img",{src:this.fallbackSrc,style:{objectFit:this.objectFit}})]):g=je(u.default,k=>{if(k)return W(Oe,{onResize:this.fitTextTransform},{default:()=>W("span",{ref:"textRef",class:`${a}-avatar__text`},k)});if(i){const{imgProps:w}=this;return W("img",Object.assign(Object.assign({},w),{loading:ee&&!this.intersectionObserverOptions&&m?"lazy":"eager",src:ee||l||n?i:void 0,onLoad:p,"data-image-src":i,onError:this.handleError,style:[w==null?void 0:w.style,{objectFit:this.objectFit},d?{height:"0",width:"0",visibility:"hidden",position:"absolute"}:""]}))}}),W("span",{ref:"selfRef",class:[`${a}-avatar`,this.themeClass],style:this.cssVars},g,m&&d)}}),pt={class:"flex flex-col ml-4 flex-1 shrink-1 w-full"},me=M({__name:"FollowItem",props:{pubkey:null,name:null,about:null},setup(r){const f=r,{pubkey:u,name:i,about:a}=T(f),[m,o]=He(()=>oe(u.value)),p=v(()=>{var l;return(l=m.value)==null?void 0:l.feat.useMetadata()});return(l,n)=>{const h=_e,g=ie,d=Je;return y(),R(d,{class:"cursor-pointer"},{default:c(()=>{var k,w,L,F,D,j;return[E("div",{ref_key:"target",ref:o,class:"flex items-center"},[s(h,{class:"ml-4",size:"small",src:(w=(k=e(p))==null?void 0:k.picture)!=null?w:e(ue),round:"",onClick:n[0]||(n[0]=()=>l.$router.push(`/profile/${e(u)}`))},null,8,["src"]),E("div",pt,[E("div",{class:"text-xl",onClick:n[1]||(n[1]=()=>l.$router.push(`/profile/${e(u)}`))},O((D=(F=e(i))!=null?F:(L=e(p))==null?void 0:L.name)!=null?D:e(u).slice(0,10)),1),(j=e(p))!=null&&j.about?(y(),R(g,{key:0,style:{fontSize:"10px"}},{default:c(()=>{var t;return[P(O((t=e(a))!=null?t:e(p).about),1)]}),_:1})):K("",!0)])],512)]}),_:1})}}}),ft={class:"p-4 box-border"},_t=M({__name:"Follow",props:{pubkey:null,urls:null},setup(r){const f=r,{pubkey:u,urls:i}=T(f),a=v(()=>ve(u.value,{urls:i==null?void 0:i.value})),m=v(()=>u.value===B.value.publicKey?J.getContactConfiguration():a.value.feat.getContactList());return(o,p)=>(y(),S("div",ft,[s(e(fe),null,{default:c(()=>[(y(!0),S(X,null,pe(e(m),l=>(y(),R(me,{key:l.pubkey,contact:l,pubkey:l.pubkey,name:l.name},null,8,["contact","pubkey","name"]))),128))]),_:1})]))}}),mt={class:"p-4 box-border"},vt=M({__name:"Follower",props:{pubkey:null,active:{type:Boolean},urls:null},setup(r){const f=r,{pubkey:u,active:i}=T(f),a=v(()=>be(u.value)),m=v(()=>a.value.getList());return Qe(a,i),(o,p)=>(y(),S("div",mt,[s(e(fe),null,{default:c(()=>[(y(!0),S(X,null,pe(e(m),l=>(y(),R(me,{key:l.pubkey,pubkey:l.pubkey},null,8,["pubkey"]))),128))]),_:1})]))}}),bt=M({__name:"ProfileMoreInfoRelayList",props:{pubkey:null,active:{type:Boolean}},setup(r){const f=r,{pubkey:u}=T(f),i=v(()=>ye(u.value)),a=v(()=>u.value===B.value.publicKey?{readUrl:I.getReadList(),writeUrl:I.getWriteList(),urls:new Set(Object.keys(I.getData()))}:i.value.feat.getReadWriteList()),m=v(()=>{var p;return(p=a.value)==null?void 0:p.urls});function o(){Ue.push({name:"relays"})}return(p,l)=>{var g;const n=N,h=he;return y(),S(X,null,[s(h,{show:e(I).hasChange()},{default:c(()=>[s(n,{onClick:o,type:"primary"},{default:c(()=>[P(O(e($)("save")),1)]),_:1})]),_:1},8,["show"]),s(et,{urls:(g=e(m))!=null?g:[],title:""},{right:c(({url:d})=>{var k,w,L,F;return[s(tt,{active:(w=(k=e(a))==null?void 0:k.writeUrl.has(d))!=null?w:!1,class:"mr-1"},null,8,["active"]),s(ot,{active:(F=(L=e(a))==null?void 0:L.readUrl.has(d))!=null?F:!1,class:"mr-2"},null,8,["active"]),s(Ze,{url:d},null,8,["url"])]}),_:1},8,["urls"])],64)}}}),yt=M({__name:"ProfileMoreInfo",props:{pubkey:null,urls:null},setup(r){const f=r,{pubkey:u}=T(f),i=v(()=>[u.value]),a=z("homepage");return(m,o)=>{const p=nt,l=at;return y(),R(l,{type:"line",value:a.value,"onUpdate:value":o[0]||(o[0]=n=>a.value=n),animated:""},{default:c(()=>[s(p,{"display-directive":"show",name:"homepage",tab:e($)("homepage")},{default:c(()=>[s(Ye,{active:a.value==="homepage",pubkeys:e(i),urls:f.urls},null,8,["active","pubkeys","urls"])]),_:1},8,["tab"]),s(p,{"display-directive":"show",name:"follow",tab:e($)("follow")},{default:c(()=>[s(_t,{active:a.value==="follow",pubkey:e(u),urls:r.urls},null,8,["active","pubkey","urls"])]),_:1},8,["tab"]),s(p,{"display-directive":"show:lazy",name:"follower",tab:e($)("follower")},{default:c(()=>[s(vt,{active:a.value==="follower",pubkey:e(u)},null,8,["active","pubkey"])]),_:1},8,["tab"]),s(p,{"display-directive":"show:lazy",name:"\u4E2D\u7EE7",tab:e($)("relay")},{default:c(()=>[s(bt,{active:a.value==="relay",pubkey:e(u)},null,8,["active","pubkey"])]),_:1},8,["tab"])]),_:1},8,["value"])}}}),ht={},gt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},kt=E("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44",d:"M358.62 129.28L86.49 402.08L70 442l39.92-16.49l272.8-272.13l-24.1-24.1z"},null,-1),wt=E("path",{d:"M413.07 74.84l-11.79 11.78l24.1 24.1l11.79-11.79a16.51 16.51 0 0 0 0-23.34l-.75-.75a16.51 16.51 0 0 0-23.35 0z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44"},null,-1),xt=[kt,wt];function $t(r,f){return y(),S("svg",gt,xt)}const Ft=ne(ht,[["render",$t]]),Ct={},Et={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Lt=E("path",{d:"M384 336a63.78 63.78 0 0 0-46.12 19.7l-148-83.27a63.85 63.85 0 0 0 0-32.86l148-83.27a63.8 63.8 0 1 0-15.73-27.87l-148 83.27a64 64 0 1 0 0 88.6l148 83.27A64 64 0 1 0 384 336z",fill:"currentColor"},null,-1),zt=[Lt];function Bt(r,f){return y(),S("svg",Et,zt)}const Rt=ne(Ct,[["render",Bt]]),St=M({__name:"UserDataEditing",emits:["close"],setup(r,{emit:f}){const u=Ke(),i=z({}),a=v(()=>oe(B.value.publicKey)),m=v(()=>a.value.feat.useMetadata());de(()=>{i.value=m.value});const o=z(!1);async function p(){o.value=!0,a.value.publish({content:JSON.stringify(i.value),kind:0},I.getWriteList(),{addUrl:!0,onOK({ok:l,url:n}){o.value=!1,l?u.success(`\u5DF2\u6210\u529F\u63D0\u4EA4\u5230${n}`):u.error(`\u63D0\u4EA4\u5230${n}\u5931\u8D25`)}})}return(l,n)=>{const h=Ie,g=Ve;return y(),R(g,{class:"w-[600px] max-w-full max-h-full",title:"\u7F16\u8F91\u7528\u6237\u4FE1\u606F",bordered:!1,role:"dialog","aria-modal":"true"},{default:c(()=>[s(e(te),{vertical:""},{default:c(()=>[s(lt,{userMetadata:i.value},null,8,["userMetadata"]),s(e(te),{center:""},{default:c(()=>[s(e(N),{type:"tertiary",onClick:n[0]||(n[0]=()=>f("close"))},{default:c(()=>[P(O(e($)("cancel")),1)]),_:1}),s(h,{trigger:"hover"},{trigger:c(()=>[s(e(N),{type:"primary",onClick:p,loading:o.value,disabled:o.value},{default:c(()=>[P(O(e($)("submit")),1)]),_:1},8,["loading","disabled"])]),default:c(()=>[P(" \u5982\u679C\u52A0\u8F7D\u4E0D\u5230\u5408\u9002\u7684\u4FE1\u606F\uFF0C\u90A3\u53EF\u80FD\u662Frelays\u8BBE\u7F6E\u4E0D\u5BF9\u8BF7\u5C1D\u8BD5\u914D\u7F6E\u4E00\u4E0B ")]),_:1}),o.value?(y(),R(h,{key:0,trigger:"hover"},{trigger:c(()=>[s(e(N),{onClick:n[1]||(n[1]=()=>o.value=!1)},{default:c(()=>[P("\u505C\u6B62\u52A0\u8F7D")]),_:1})]),default:c(()=>[P(" \u5982\u679C\u60A8\u662F\u65B0\u7528\u6237\u7684\u8BDD\uFF0C\u6216\u8005\u60A8\u653E\u5F03\u4E4B\u524D\u7684\u4FE1\u606F\u5C31\u53EF\u4EE5\u70B9\u6B64\u5904 ")]),_:1})):K("",!0)]),_:1})]),_:1})]),_:1})}}}),Pt=M({__name:"UserInformationButton",props:{pubkey:null},setup(r){const f=r,{pubkey:u}=T(f),i=rt(),a=v(()=>u.value===B.value.publicKey),m=z(!1),o=ge(),p=ke(),l=z([a.value&&{label:$("edit_user_profile"),key:"editProfile",icon:se(Ft),props:{onclick(){m.value=!m.value}}},{label:$("copy"),key:"clipboard",icon:se(Rt),children:[{label:`${$("copy")} npub`,key:"copy-npub",props:{onclick(){const n=Q.npubEncode(B.value.publicKey);i(n)}}},{label:`${$("copy")} nprofile`,key:"copy-npro",props:{onclick(){const n=Q.nprofileEncode({pubkey:B.value.publicKey,relays:[...I.getWriteList()]});i(n)}}},a.value&&{label:`${$("copy")} nsec`,key:"copy-nsec",props:{onclick(){const n=Q.nsecEncode(B.value.privateKey);i(n)}}},{label:`${$("copy")} publicKey hex`,key:"copy-hex",props:{onclick(){i(B.value.publicKey)}}}].filter(n=>!!n)},{label:$("recommend_user"),key:"recommendUser",props:{onclick(){o(u.value)}}},{label:$("recommend_metadata"),key:"recommendUserMetadata",props:{onclick(){p(u.value)}}}].filter(n=>!!n));return(n,h)=>{const g=N,d=st,k=Ae;return y(),S(X,null,[s(d,{placement:"bottom-start",trigger:"click",options:l.value},{default:c(()=>[s(g,{circle:"",type:"info"},{default:c(()=>[s(we)]),_:1})]),_:1},8,["options"]),s(k,{show:m.value,"onUpdate:show":h[1]||(h[1]=w=>m.value=w)},{default:c(()=>[s(St,{onClose:h[0]||(h[0]=()=>m.value=!1)})]),_:1},8,["show"])],64)}}}),Mt={key:0,class:"w-full h-full flex flex-col"},Dt={class:"flex flex-col"},jt={class:"flex items-center justify-end px-8 mt-4"},Ot={key:1},Ut={class:"flex items-center"},Kt={class:"w-full",style:{"word-break":"break-all","text-overflow":"ellipsis","word-wrap":"break-word"}},It=M({__name:"ProfileView",setup(r){const f=Te(),u=Q.nprofileEncode({pubkey:B.value.publicKey,relays:Array.from(I.getWriteList())}),i=v(()=>{var d;return(d=f.params.value)!=null?d:u}),a=v(()=>ut(i.value)),m=v(()=>{var d;return((d=a.value)==null?void 0:d.pubkey)===B.value.publicKey}),o=v(()=>{var d;return(d=a.value)==null?void 0:d.pubkey}),p=v(()=>{var d,k;return((d=a.value)==null?void 0:d.relays)&&new Set((k=a.value)==null?void 0:k.relays)}),l=v(()=>o.value?oe(o.value,{urls:p.value}).feat.useMetadata():null),n=v(()=>o.value?J.isFollow(o.value):!1);function h(){!o.value||(n.value?J.unFollow(o.value):J.follow(o.value))}const[g]=Ge(.3);return(d,k)=>{const w=We,L=_e,F=N,D=te;return e(o)?(y(),S("div",Mt,[s(Xe,{class:"flex-shrink flex-1 h-0",refreshable:"",loadable:""},{default:c(()=>{var j,t,_,x,b,C,V,U,A;return[E("div",Dt,[E("div",{ref_key:"target",ref:g,class:"h-0 w-full relative flex-shrink-0",style:{}},[((_=(j=e(l))==null?void 0:j.banner)!=null?_:(t=e(l))==null?void 0:t.picture)?(y(),R(w,{key:0,src:(C=(x=e(l))==null?void 0:x.banner)!=null?C:(b=e(l))==null?void 0:b.picture,"object-fit":"cover",class:"w-full h-full banner"},null,8,["src"])):K("",!0),s(L,{class:"absolute bottom-0 left-2",style:Ne({transform:"translate(0,50%)"}),round:"",size:100,src:(U=(V=e(l))==null?void 0:V.picture)!=null?U:e(ue)},null,8,["style","src"])],512),E("div",null,[E("div",jt,[s(D,null,{default:c(()=>[e(m)?K("",!0):(y(),R(F,{key:0,class:"ml-4",strong:"",round:"",type:e(n)?"warning":"primary",onClick:h},{default:c(()=>[P(O(e(n)?"UnFollow":"Follow"),1)]),_:1},8,["type"])),e(o)?(y(),S("div",Ot,[s(Pt,{pubkey:e(o)},null,8,["pubkey"])])):K("",!0)]),_:1})]),E("h1",Ut,[s(ie,null,{default:c(()=>{var H,G,q;return[P(O((q=(H=e(l))==null?void 0:H.name)!=null?q:(G=e(a))==null?void 0:G.pubkey.slice(0,10)),1)]}),_:1})]),E("div",Kt,O((A=e(l))==null?void 0:A.about),1)])]),e(o)?(y(),R(yt,{key:0,pubkey:e(o),urls:e(p)},null,8,["pubkey","urls"])):K("",!0)]}),_:1})])):K("",!0)}}});const zo=ne(It,[["__scopeId","data-v-5fb6d0db"]]);export{zo as default};
