import{g as be,c as Y,a as ye}from"./Contact.f91985c7.js";import{g as ne,a as ge}from"./user.c6ea6a80.js";import{p as ue,a as he,i as ke,j as we,k as xe}from"./Content.676f5600.js";import{E as te}from"./Ellipsis.fb8816b2.js";import{l as Fe,c as re,cp as $e,b as X,cq as Ee,d as le,f as M,u as Ce,ap as z,m as se,n as v,h as ce,eP as ze,aw as Le,o as Be,q as Re,eM as Se,aE as Pe,eQ as ee,aG as de,eR as Me,b4 as De,w as je,v as Oe,j as W,aJ as Ue,bw as N,y as g,z as S,A as u,aP as L,H as l,C as e,D as B,F as j,G as U,I as P,L as Q,J as pe,V as R,au as Ie,ab as I,cZ as Ke,_ as A,O as F,bt as ae,bs as Ve,c5 as Ae,aZ as Ne,an as q,eS as Te,aY as We,Q as He,cY as Ge}from"./index.0e420a7a.js";import{l as Je,g as fe,p as Ye}from"./use.7b5663cd.js";import{t as qe}from"./Tag.9b8ca562.js";import{a as Qe,_ as me}from"./ListItem.629762b8.js";import{u as Ze,S as Xe}from"./Scrollbar.3fc623a0.js";import{_ as et}from"./PostList.vue_vue_type_script_setup_true_lang.8bddfec7.js";import{a as tt}from"./RelayAddButton.vue_vue_type_script_setup_true_lang.4b63e740.js";import{a as ot}from"./AddButton.vue_vue_type_script_setup_true_lang.fda19e14.js";import{_ as nt,a as at}from"./RelayWritableButton.vue_vue_type_script_setup_true_lang.96736d27.js";import{_ as rt,a as lt}from"./Tabs.e123bf3c.js";import{u as st,r as ie}from"./naiveUi.7e1d9910.js";import{_ as it}from"./UserMetadataEditing.vue_vue_type_script_setup_true_lang.6b826e0c.js";import{_ as oe}from"./Space.45ef5f62.js";import{_ as ut}from"./Dropdown.21956391.js";import{a as ct}from"./nostr.2e66b318.js";import"./getCacheStaff.ce5a8b54.js";import"./createGarbageFilter.9d7b3860.js";import"./channel.f7cdd32d.js";import"./autoAddRelayurlByEventIdStaff.8ca2f449.js";import"./ContentBlacklistView.9493daed.js";import"./Input.4bb7b199.js";import"./event.e7c9f230.js";import"./MavonEditor.ce482362.js";import"./use-theme-vars.4eddaf97.js";import"./Icon.80a71b9a.js";import"./Drawer.vue_vue_type_script_setup_true_lang.d4f4dec1.js";import"./DrawerContent.1892dd15.js";import"./RelayInfoView.1000451d.js";import"./Popselect.e928699a.js";import"./create.2deeaf6a.js";import"./Checkmark.2aca7293.js";import"./VirtualList.a319de25.js";import"./Empty.3f22b2fc.js";import"./create-ref-setter.fe4a2903.js";import"./UserLink.vue_vue_type_script_setup_true_lang.a7ca9f69.js";import"./ReloadCircleSharp.0893bcb5.js";import"./Scrollbar.d43e7a6d.js";import"./PapawList.vue_vue_type_script_setup_true_lang.30b43373.js";import"./composables.c2f0fe21.js";import"./UploadButton.vue_vue_type_script_setup_true_lang.f8a131e7.js";import"./CloudUpload.d0cb87ab.js";import"./get-slot.4ceacf82.js";const dt=Fe("n-avatar-group"),pt=re("avatar",`
 width: var(--n-merged-size);
 height: var(--n-merged-size);
 color: #FFF;
 font-size: var(--n-font-size);
 display: inline-flex;
 position: relative;
 overflow: hidden;
 text-align: center;
 border: var(--n-border);
 border-radius: var(--n-border-radius);
 --n-merged-color: var(--n-color);
 background-color: var(--n-merged-color);
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
`,[$e(X("&","--n-merged-color: var(--n-color-modal);")),Ee(X("&","--n-merged-color: var(--n-color-popover);")),X("img",`
 width: 100%;
 height: 100%;
 `),le("text",`
 white-space: nowrap;
 display: inline-block;
 position: absolute;
 left: 50%;
 top: 50%;
 `),re("icon",`
 vertical-align: bottom;
 font-size: calc(var(--n-merged-size) - 6px);
 `),le("text","line-height: 1.25")]),ft=Object.assign(Object.assign({},ce.props),{size:[String,Number],src:String,circle:{type:Boolean,default:void 0},objectFit:String,round:{type:Boolean,default:void 0},bordered:{type:Boolean,default:void 0},onError:Function,fallbackSrc:String,intersectionObserverOptions:Object,lazy:Boolean,onLoad:Function,renderPlaceholder:Function,renderFallback:Function,imgProps:Object,color:String}),_e=M({name:"Avatar",props:ft,setup(r){const{mergedClsPrefixRef:p,inlineThemeDisabled:s}=Ce(r),a=z(!1);let i=null;const f=z(null),t=z(null),m=()=>{const{value:n}=f;if(n&&(i===null||i!==n.innerHTML)){i=n.innerHTML;const{value:_}=t;if(_){const{offsetWidth:x,offsetHeight:y}=_,{offsetWidth:C,offsetHeight:K}=n,O=.9,V=Math.min(x/C*O,y/K*O,1);n.style.transform=`translateX(-50%) translateY(-50%) scale(${V})`}}},c=se(dt,null),o=v(()=>{const{size:n}=r;if(n)return n;const{size:_}=c||{};return _||"medium"}),b=ce("Avatar","-avatar",pt,ze,r,p),h=se(qe,null),d=v(()=>{if(c)return!0;const{round:n,circle:_}=r;return n!==void 0||_!==void 0?n||_:h?h.roundRef.value:!1}),k=v(()=>c?!0:r.bordered||!1),w=n=>{var _;if(!D.value)return;a.value=!0;const{onError:x,imgProps:y}=r;(_=y==null?void 0:y.onError)===null||_===void 0||_.call(y,n),x&&x(n)};Le(()=>r.src,()=>a.value=!1);const E=v(()=>{const n=o.value,_=d.value,x=k.value,{color:y}=r,{self:{borderRadius:C,fontSize:K,color:O,border:V,colorModal:H,colorPopover:G},common:{cubicBezierEaseInOut:J}}=b.value;let Z;return typeof n=="number"?Z=`${n}px`:Z=b.value.self[Be("height",n)],{"--n-font-size":K,"--n-border":x?V:"none","--n-border-radius":_?"50%":C,"--n-color":y||O,"--n-color-modal":y||H,"--n-color-popover":y||G,"--n-bezier":J,"--n-merged-size":`var(--n-avatar-size-override, ${Z})`}}),$=s?Re("avatar",v(()=>{const n=o.value,_=d.value,x=k.value,{color:y}=r;let C="";return n&&(typeof n=="number"?C+=`a${n}`:C+=n[0]),_&&(C+="b"),x&&(C+="c"),y&&(C+=Se(y)),C}),E,r):void 0,D=z(!r.lazy);Pe(()=>{if(ee)return;let n;const _=de(()=>{n==null||n(),n=void 0,r.lazy&&(n=Me(t.value,r.intersectionObserverOptions,D))});De(()=>{_(),n==null||n()})});const T=z(!r.lazy);return{textRef:f,selfRef:t,mergedRoundRef:d,mergedClsPrefix:p,fitTextTransform:m,cssVars:s?void 0:E,themeClass:$==null?void 0:$.themeClass,onRender:$==null?void 0:$.onRender,hasLoadError:a,handleError:w,shouldStartLoading:D,loaded:T,mergedOnLoad:n=>{var _;const{onLoad:x,imgProps:y}=r;x==null||x(n),(_=y==null?void 0:y.onLoad)===null||_===void 0||_.call(y,n),T.value=!0}}},render(){var r,p;const{$slots:s,src:a,mergedClsPrefix:i,lazy:f,onRender:t,mergedOnLoad:m,shouldStartLoading:c,loaded:o,hasLoadError:b}=this;t==null||t();let h;const d=!o&&!b&&(this.renderPlaceholder?this.renderPlaceholder():(p=(r=this.$slots).placeholder)===null||p===void 0?void 0:p.call(r));return this.hasLoadError?h=this.renderFallback?this.renderFallback():je(s.fallback,()=>[W("img",{src:this.fallbackSrc,style:{objectFit:this.objectFit}})]):h=Oe(s.default,k=>{if(k)return W(Ue,{onResize:this.fitTextTransform},{default:()=>W("span",{ref:"textRef",class:`${i}-avatar__text`},k)});if(a){const{imgProps:w}=this;return W("img",Object.assign(Object.assign({},w),{loading:ee&&!this.intersectionObserverOptions&&f?"lazy":"eager",src:ee||c||o?a:void 0,onLoad:m,"data-image-src":a,onError:this.handleError,style:[w==null?void 0:w.style,{objectFit:this.objectFit},d?{height:"0",width:"0",visibility:"hidden",position:"absolute"}:""]}))}}),W("span",{ref:"selfRef",class:[`${i}-avatar`,this.themeClass],style:this.cssVars},h,f&&d)}}),mt={class:"flex flex-col ml-4 flex-1 shrink-1 w-full"},ve=M({__name:"FollowItem",props:{pubkey:null,name:null,about:null},setup(r){const p=r,{pubkey:s,name:a,about:i}=N(p),[f,t]=Je(()=>ne(s.value)),m=v(()=>{var c;return(c=f.value)==null?void 0:c.feat.useMetadata()});return(c,o)=>{const b=_e,h=Qe;return g(),S(h,{class:"cursor-pointer overflow-hidden"},{default:u(()=>{var d,k,w;return[L("div",{ref_key:"target",ref:t,class:"flex items-center"},[l(b,{class:"ml-4",size:"small",src:(k=(d=e(m))==null?void 0:d.picture)!=null?k:e(ue),round:"",onClick:o[0]||(o[0]=()=>c.$router.push(`/profile/${e(s)}`))},null,8,["src"]),L("div",mt,[l(te,{class:"text-xl",onClick:o[1]||(o[1]=()=>c.$router.push(`/profile/${e(s)}`))},{default:u(()=>{var E,$,D;return[B(j((D=($=e(a))!=null?$:(E=e(m))==null?void 0:E.name)!=null?D:e(s).slice(0,10)),1)]}),_:1}),(w=e(m))!=null&&w.about?(g(),S(te,{key:0,style:{fontSize:"10px"}},{default:u(()=>{var E;return[B(j((E=e(i))!=null?E:e(m).about),1)]}),_:1})):U("",!0)])],512)]}),_:1})}}}),_t=M({__name:"Follow",props:{pubkey:null,urls:null,active:{type:Boolean}},setup(r){const p=r,{pubkey:s,urls:a,active:i}=N(p),f=v(()=>be(s.value,{urls:a==null?void 0:a.value})),t=v(()=>s.value===R.value.publicKey?Y.getContactConfiguration():f.value.feat.getContactList()),m=z(void 0);return fe(m,{active:i}),(c,o)=>(g(),P("div",{ref_key:"divRef",ref:m,class:"p-4 box-border"},[l(e(me),null,{default:u(()=>[(g(!0),P(Q,null,pe(e(t),b=>(g(),S(ve,{key:b.pubkey,contact:b,pubkey:b.pubkey,name:b.name},null,8,["contact","pubkey","name"]))),128))]),_:1})],512))}}),vt=M({__name:"Follower",props:{pubkey:null,active:{type:Boolean},urls:null},setup(r){const p=r,{pubkey:s,active:a}=N(p),i=v(()=>ye(s.value)),f=v(()=>i.value.getList());Ze(i,a);const t=z(void 0);return fe(t,{active:Ie(p,"active")}),(m,c)=>(g(),P("div",{ref_key:"divRef",ref:t,class:"p-4 box-border"},[l(e(me),null,{default:u(()=>[(g(!0),P(Q,null,pe(e(f),o=>(g(),S(ve,{key:o.pubkey,pubkey:o.pubkey},null,8,["pubkey"]))),128))]),_:1})],512))}}),bt=M({__name:"ProfileMoreInfoRelayList",props:{pubkey:null,active:{type:Boolean}},setup(r){const p=r,{pubkey:s}=N(p),a=v(()=>ge(s.value)),i=v(()=>s.value===R.value.publicKey?{readUrl:I.getReadList(),writeUrl:I.getWriteList(),urls:new Set(Object.keys(I.getData()))}:a.value.feat.getReadWriteList()),f=v(()=>{var m;return(m=i.value)==null?void 0:m.urls});function t(){Ke.push({name:"relays"})}return(m,c)=>{var h;const o=A,b=he;return g(),P(Q,null,[l(b,{show:e(I).hasChange()},{default:u(()=>[l(o,{onClick:t,type:"primary"},{default:u(()=>[B(j(e(F)("save")),1)]),_:1})]),_:1},8,["show"]),l(ot,{urls:(h=e(f))!=null?h:[],title:""},{right:u(({url:d})=>{var k,w,E,$;return[l(nt,{active:(w=(k=e(i))==null?void 0:k.writeUrl.has(d))!=null?w:!1,class:"mr-1"},null,8,["active"]),l(at,{active:($=(E=e(i))==null?void 0:E.readUrl.has(d))!=null?$:!1,class:"mr-2"},null,8,["active"]),l(tt,{url:d},null,8,["url"])]}),_:1},8,["urls"])],64)}}}),yt=M({__name:"ProfileMoreInfo",props:{pubkey:null,urls:null},setup(r){const p=r,{pubkey:s}=N(p);v(()=>[s.value]);const a=z("homepage");return(i,f)=>{const t=rt,m=lt;return g(),S(m,{type:"line",value:a.value,"onUpdate:value":f[0]||(f[0]=c=>a.value=c),animated:""},{default:u(()=>[l(t,{"display-directive":"show:lazy",name:"homepage",tab:e(F)("homepage")},{default:u(()=>[l(et,{active:a.value==="homepage",filters:[{kinds:[30023],authors:[e(s)]},{kinds:[1],authors:[e(s)]}],urls:p.urls},null,8,["active","filters","urls"])]),_:1},8,["tab"]),l(t,{"display-directive":"show:lazy",name:"follow",tab:e(F)("follow")},{default:u(()=>[l(_t,{active:a.value==="follow",pubkey:e(s),urls:r.urls},null,8,["active","pubkey","urls"])]),_:1},8,["tab"]),l(t,{"display-directive":"show:lazy",name:"follower",tab:e(F)("follower")},{default:u(()=>[l(vt,{active:a.value==="follower",pubkey:e(s)},null,8,["active","pubkey"])]),_:1},8,["tab"]),l(t,{"display-directive":"show:lazy",name:"\u4E2D\u7EE7",tab:e(F)("relay")},{default:u(()=>[l(bt,{active:a.value==="relay",pubkey:e(s)},null,8,["active","pubkey"])]),_:1},8,["tab"])]),_:1},8,["value"])}}}),gt={},ht={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},kt=L("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44",d:"M358.62 129.28L86.49 402.08L70 442l39.92-16.49l272.8-272.13l-24.1-24.1z"},null,-1),wt=L("path",{d:"M413.07 74.84l-11.79 11.78l24.1 24.1l11.79-11.79a16.51 16.51 0 0 0 0-23.34l-.75-.75a16.51 16.51 0 0 0-23.35 0z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44"},null,-1),xt=[kt,wt];function Ft(r,p){return g(),P("svg",ht,xt)}const $t=ae(gt,[["render",Ft]]),Et={},Ct={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},zt=L("path",{d:"M384 336a63.78 63.78 0 0 0-46.12 19.7l-148-83.27a63.85 63.85 0 0 0 0-32.86l148-83.27a63.8 63.8 0 1 0-15.73-27.87l-148 83.27a64 64 0 1 0 0 88.6l148 83.27A64 64 0 1 0 384 336z",fill:"currentColor"},null,-1),Lt=[zt];function Bt(r,p){return g(),P("svg",Ct,Lt)}const Rt=ae(Et,[["render",Bt]]),St=M({__name:"UserDataEditing",emits:["close"],setup(r,{emit:p}){const s=Ve(),a=z({}),i=v(()=>ne(R.value.publicKey)),f=v(()=>i.value.feat.useMetadata());de(()=>{a.value=f.value});const t=z(!1);async function m(){t.value=!0,i.value.publish({content:JSON.stringify(a.value),kind:0},I.getWriteList(),{addUrl:!0,onOK({ok:c,url:o}){t.value=!1,c?s.success(`\u5DF2\u6210\u529F\u63D0\u4EA4\u5230${o}`):s.error(`\u63D0\u4EA4\u5230${o}\u5931\u8D25`)}})}return(c,o)=>{const b=Ae,h=Ne;return g(),S(h,{class:"w-[600px] max-w-full max-h-full",title:"\u7F16\u8F91\u7528\u6237\u4FE1\u606F",bordered:!1,role:"dialog","aria-modal":"true"},{default:u(()=>[l(e(oe),{vertical:""},{default:u(()=>[l(it,{userMetadata:a.value},null,8,["userMetadata"]),l(e(oe),{center:""},{default:u(()=>[l(e(A),{type:"tertiary",onClick:o[0]||(o[0]=()=>p("close"))},{default:u(()=>[B(j(e(F)("cancel")),1)]),_:1}),l(b,{trigger:"hover"},{trigger:u(()=>[l(e(A),{type:"primary",onClick:m,loading:t.value,disabled:t.value},{default:u(()=>[B(j(e(F)("submit")),1)]),_:1},8,["loading","disabled"])]),default:u(()=>[B(" \u5982\u679C\u52A0\u8F7D\u4E0D\u5230\u5408\u9002\u7684\u4FE1\u606F\uFF0C\u90A3\u53EF\u80FD\u662Frelays\u8BBE\u7F6E\u4E0D\u5BF9\u8BF7\u5C1D\u8BD5\u914D\u7F6E\u4E00\u4E0B ")]),_:1}),t.value?(g(),S(b,{key:0,trigger:"hover"},{trigger:u(()=>[l(e(A),{onClick:o[1]||(o[1]=()=>t.value=!1)},{default:u(()=>[B("\u505C\u6B62\u52A0\u8F7D")]),_:1})]),default:u(()=>[B(" \u5982\u679C\u60A8\u662F\u65B0\u7528\u6237\u7684\u8BDD\uFF0C\u6216\u8005\u60A8\u653E\u5F03\u4E4B\u524D\u7684\u4FE1\u606F\u5C31\u53EF\u4EE5\u70B9\u6B64\u5904 ")]),_:1})):U("",!0)]),_:1})]),_:1})]),_:1})}}}),Pt=M({__name:"UserInformationButton",props:{pubkey:null},setup(r){const p=r,{pubkey:s}=N(p),a=st(),i=v(()=>s.value===R.value.publicKey),f=z(!1),t=ke(),m=we(),c=z([i.value&&{label:F("edit_user_profile"),key:"editProfile",icon:ie($t),props:{onclick(){f.value=!f.value}}},{label:F("copy"),key:"clipboard",icon:ie(Rt),children:[{label:`${F("copy")} npub`,key:"copy-npub",props:{onclick(){const o=q.npubEncode(R.value.publicKey);a(o)}}},{label:`${F("copy")} nprofile`,key:"copy-npro",props:{onclick(){const o=q.nprofileEncode({pubkey:R.value.publicKey,relays:[...I.getWriteList()]});a(o)}}},i.value&&{label:`${F("copy")} nsec`,key:"copy-nsec",props:{onclick(){const o=q.nsecEncode(R.value.privateKey);a(o)}}},{label:`${F("copy")} publicKey hex`,key:"copy-hex",props:{onclick(){a(R.value.publicKey)}}}].filter(o=>!!o)},{label:F("recommend_user"),key:"recommendUser",props:{onclick(){t(s.value)}}},{label:F("recommend_metadata"),key:"recommendUserMetadata",props:{onclick(){m(s.value)}}}].filter(o=>!!o));return(o,b)=>{const h=A,d=ut,k=Te;return g(),P(Q,null,[l(d,{placement:"bottom-start",trigger:"click",options:c.value},{default:u(()=>[l(h,{circle:"",type:"info"},{default:u(()=>[l(xe)]),_:1})]),_:1},8,["options"]),l(k,{show:f.value,"onUpdate:show":b[1]||(b[1]=w=>f.value=w)},{default:u(()=>[l(St,{onClose:b[0]||(b[0]=()=>f.value=!1)})]),_:1},8,["show"])],64)}}}),Mt={key:0,class:"w-full h-full flex flex-col"},Dt={class:"flex flex-col"},jt={class:"flex items-center justify-end px-8 mt-4"},Ot={key:1},Ut={class:"flex items-center"},It={class:"w-full",style:{"word-break":"break-all","text-overflow":"ellipsis","word-wrap":"break-word"}},Kt=M({__name:"ProfileView",setup(r){const p=He(),s=q.nprofileEncode({pubkey:R.value.publicKey,relays:Array.from(I.getWriteList())}),a=v(()=>{var d;return(d=p.params.value)!=null?d:s}),i=v(()=>ct(a.value)),f=v(()=>{var d;return((d=i.value)==null?void 0:d.pubkey)===R.value.publicKey}),t=v(()=>{var d;return(d=i.value)==null?void 0:d.pubkey}),m=v(()=>{var d,k;return((d=i.value)==null?void 0:d.relays)&&new Set((k=i.value)==null?void 0:k.relays)}),c=v(()=>t.value?ne(t.value,{urls:m.value}).feat.useMetadata():null),o=v(()=>t.value?Y.isFollow(t.value):!1);function b(){!t.value||(o.value?Y.unFollow(t.value):Y.follow(t.value))}const[h]=Ye(.3);return(d,k)=>{const w=Ge,E=_e,$=A,D=oe;return e(t)?(g(),P("div",Mt,[l(Xe,{class:"flex-shrink flex-1 h-0",refreshable:"",loadable:""},{default:u(()=>{var T,n,_,x,y,C,K,O,V;return[L("div",Dt,[L("div",{ref_key:"target",ref:h,class:"h-0 w-full relative flex-shrink-0",style:{}},[((_=(T=e(c))==null?void 0:T.banner)!=null?_:(n=e(c))==null?void 0:n.picture)?(g(),S(w,{key:0,src:(C=(x=e(c))==null?void 0:x.banner)!=null?C:(y=e(c))==null?void 0:y.picture,"object-fit":"cover",class:"w-full h-full banner"},null,8,["src"])):U("",!0),l(E,{class:"absolute bottom-0 left-2",style:We({transform:"translate(0,50%)"}),round:"",size:100,src:(O=(K=e(c))==null?void 0:K.picture)!=null?O:e(ue)},null,8,["style","src"])],512),L("div",null,[L("div",jt,[l(D,null,{default:u(()=>[e(f)?U("",!0):(g(),S($,{key:0,class:"ml-4",strong:"",round:"",type:e(o)?"warning":"primary",onClick:b},{default:u(()=>[B(j(e(o)?"UnFollow":"Follow"),1)]),_:1},8,["type"])),e(t)?(g(),P("div",Ot,[l(Pt,{pubkey:e(t)},null,8,["pubkey"])])):U("",!0)]),_:1})]),L("h1",Ut,[l(te,null,{default:u(()=>{var H,G,J;return[B(j((J=(H=e(c))==null?void 0:H.name)!=null?J:(G=e(i))==null?void 0:G.pubkey.slice(0,10)),1)]}),_:1})]),L("div",It,j((V=e(c))==null?void 0:V.about),1)])]),e(t)?(g(),S(yt,{key:0,pubkey:e(t),urls:e(m)},null,8,["pubkey","urls"])):U("",!0)]}),_:1})])):U("",!0)}}});const Mo=ae(Kt,[["__scopeId","data-v-5fb6d0db"]]);export{Mo as default};
